(function(a){a.vakata={}})(jQuery);(function(a){a.fn.vakata_reverse=[].reverse})(jQuery);(function(a){jQuery.expr[":"].vakata_icontains=function(c,d,b){return(c.textContent||c.innerText||"").toLowerCase().indexOf(b[3].toLowerCase())>=0}})(jQuery);(function(a){a.vakata.array_remove=function(e,d,c){var b=e.slice((c||d)+1||e.length);e.length=d<0?e.length+d:d;e.push.apply(e,b);return e}})(jQuery);(function(a){a.vakata.array_unique=function(f){var c=[],e,d,b;for(e=0,b=f.length;e<b;e++){for(d=0;d<=e;d++){if(f[e]===f[d]){break}}if(d===e){c.push(f[e])}}return c}})(jQuery);(function(a){a.vakata.attributes=function(c,d){c=a(c)[0];var b=d?{}:[];a.each(c.attributes,function(f,e){if(a.inArray(e.nodeName.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])!==-1){return}if(e.nodeValue!==null&&a.trim(e.nodeValue)!==""){if(d){b[e.nodeName]=e.nodeValue}else{b.push(e.nodeName)}}});return b}})(jQuery);(function(a){var b;a.vakata.get_scrollbar_width=function(){var d,c;if(!b){if(/msie/.test(navigator.userAgent.toLowerCase())){d=a('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1000,left:0}).appendTo("body");c=a('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1000,left:0}).appendTo("body");b=d.width()-c.width();d.add(c).remove()}else{d=a("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1000,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200});b=100-d.width();d.parent().remove()}}return b}})(jQuery);(function(a){a.vakata.css={get_css:function(f,c,d){f=f.toLowerCase();var e=d.cssRules||d.rules,b=0;do{if(e.length&&b>e.length+5){return false}if(e[b].selectorText&&e[b].selectorText.toLowerCase()===f){if(c===true){if(d.removeRule){d.removeRule(b)}if(d.deleteRule){d.deleteRule(b)}return true}else{return e[b]}}}while(e[++b]);return false},add_css:function(c,b){if(a.jstree.css.get_css(c,false,b)){return false}if(b.insertRule){b.insertRule(c+" { }",0)}else{b.addRule(c,null,0)}return a.vakata.css.get_css(c)},remove_css:function(c,b){return a.vakata.css.get_css(c,true,b)},add_sheet:function(c){var b=false,f=true;if(c.str){if(c.title){b=a("style[id='"+c.title+"-stylesheet']")[0]}if(b){f=false}else{b=document.createElement("style");b.setAttribute("type","text/css");if(c.title){b.setAttribute("id",c.title+"-stylesheet")}}if(b.styleSheet){if(f){document.getElementsByTagName("head")[0].appendChild(b);b.styleSheet.cssText=c.str}else{b.styleSheet.cssText=b.styleSheet.cssText+" "+c.str}}else{b.appendChild(document.createTextNode(c.str));document.getElementsByTagName("head")[0].appendChild(b)}return b.sheet||b.styleSheet}if(c.url){if(document.createStyleSheet){try{b=document.createStyleSheet(c.url)}catch(d){}}else{b=document.createElement("link");b.rel="stylesheet";b.type="text/css";b.media="all";b.href=c.url;document.getElementsByTagName("head")[0].appendChild(b);return b.styleSheet}}}}})(jQuery);(function(b){var a={element:false,is_down:false,is_drag:false,helper:false,helper_w:0,data:false,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:false,scroll_i:false};b.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5},_trigger:function(f,d){var c=b.vakata.dnd._get();c.event=d;b(document).triggerHandler("dnd_"+f+".vakata",c)},_get:function(){return{data:a.data,element:a.element,helper:a.helper}},_clean:function(){if(a.helper){a.helper.remove()}if(a.scroll_i){clearInterval(a.scroll_i);a.scroll_i=false}a={element:false,is_down:false,is_drag:false,helper:false,helper_w:0,data:false,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:false,scroll_i:false};b(document).unbind("mousemove",b.vakata.dnd.drag);b(document).unbind("mouseup",b.vakata.dnd.stop)},_scroll:function(e){if(!a.scroll_e||(!a.scroll_l&&!a.scroll_t)){if(a.scroll_i){clearInterval(a.scroll_i);a.scroll_i=false}return false}if(!a.scroll_i){a.scroll_i=setInterval(b.vakata.dnd._scroll,100);return false}if(e===true){return false}var d=a.scroll_e.scrollTop(),c=a.scroll_e.scrollLeft();a.scroll_e.scrollTop(d+a.scroll_t*b.vakata.dnd.settings.scroll_speed);a.scroll_e.scrollLeft(c+a.scroll_l*b.vakata.dnd.settings.scroll_speed);if(d!==a.scroll_e.scrollTop()||c!==a.scroll_e.scrollLeft()){b.vakata.dnd._trigger("scroll",a.scroll_e)}},start:function(g,f,c){if(a.is_drag){b.vakata.dnd.stop({})}try{g.currentTarget.unselectable="on";g.currentTarget.onselectstart=function(){return false};if(g.currentTarget.style){g.currentTarget.style.MozUserSelect="none"}}catch(d){}a.init_x=g.pageX;a.init_y=g.pageY;a.data=f;a.is_down=true;a.element=g.currentTarget;if(c!==false){a.helper=b("<div id='vakata-dnd'></div>").html(c).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})}b(document).bind("mousemove",b.vakata.dnd.drag);b(document).bind("mouseup",b.vakata.dnd.stop);return false},drag:function(l){if(!a.is_down){return}if(!a.is_drag){if(Math.abs(l.pageX-a.init_x)>b.vakata.dnd.settings.threshold||Math.abs(l.pageY-a.init_y)>b.vakata.dnd.settings.threshold){if(a.helper){a.helper.appendTo("body");a.helper_w=a.helper.outerWidth()}a.is_drag=true;b.vakata.dnd._trigger("start",l)}else{return}}var m=false,q=false,n=false,f=false,c=false,j=false,i=false,k=false,o=false,h=false;a.scroll_t=0;a.scroll_l=0;a.scroll_e=false;var g=b(l.target).parentsUntil("body").andSelf().vakata_reverse().filter(function(){return(/^auto|scroll$/).test(b(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var d=b(this),e=d.offset();if(this.scrollHeight>this.offsetHeight){if(e.top+d.height()-l.pageY<b.vakata.dnd.settings.scroll_proximity){a.scroll_t=1}if(l.pageY-e.top<b.vakata.dnd.settings.scroll_proximity){a.scroll_t=-1}}if(this.scrollWidth>this.offsetWidth){if(e.left+d.width()-l.pageX<b.vakata.dnd.settings.scroll_proximity){a.scroll_l=1}if(l.pageX-e.left<b.vakata.dnd.settings.scroll_proximity){a.scroll_l=-1}}if(a.scroll_t||a.scroll_l){a.scroll_e=b(this);return false}});if(!a.scroll_e){m=b(document);q=b(window);n=m.height();f=q.height();c=m.width();j=q.width();i=m.scrollTop();k=m.scrollLeft();if(n>f&&l.pageY-i<b.vakata.dnd.settings.scroll_proximity){a.scroll_t=-1}if(n>f&&f-(l.pageY-i)<b.vakata.dnd.settings.scroll_proximity){a.scroll_t=1}if(c>j&&l.pageX-k<b.vakata.dnd.settings.scroll_proximity){a.scroll_l=-1}if(c>j&&j-(l.pageX-k)<b.vakata.dnd.settings.scroll_proximity){a.scroll_l=1}if(a.scroll_t||a.scroll_l){a.scroll_e=m}}if(a.scroll_e){b.vakata.dnd._scroll(true)}if(a.helper){o=parseInt(l.pageY+b.vakata.dnd.settings.helper_top,10);h=parseInt(l.pageX+b.vakata.dnd.settings.helper_left,10);if(n&&o+25>n){o=n-50}if(c&&h+a.helper_w>c){h=c-(a.helper_w+2)}a.helper.css({left:h+"px",top:o+"px"})}b.vakata.dnd._trigger("move",l)},stop:function(c){if(a.is_drag){b.vakata.dnd._trigger("stop",c)}b.vakata.dnd._clean()}}})(jQuery);(function(a){a.vakata.xslt=function(b,c){var f=false,i,g,d;if(f===false&&window.ActiveXObject){try{f=new ActiveXObject("Msxml2.XSLTemplate");g=new ActiveXObject("Msxml2.DOMDocument");g.loadXML(b);d=new ActiveXObject("Msxml2.FreeThreadedDOMDocument");d.loadXML(c);f.stylesheet=d;i=f.createProcessor();i.input=g;i.transform();f=i.output}catch(h){}}b=a.parseXML(b);c=a.parseXML(c);if(f===false&&typeof(XSLTProcessor)!=="undefined"){i=new XSLTProcessor();i.importStylesheet(c);f=i.transformToFragment(b,document);f=a("<div />").append(f).html()}if(f===false&&typeof(b.transformNode)!=="undefined"){f=b.transformNode(c)}return f}})(jQuery);if(typeof jQuery.hotkeys==="undefined"){(function(a){a.vakata_hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};function b(d){if(typeof d.data!=="string"){return}var c=d.handler,e=d.data.toLowerCase().split(" ");d.handler=function(n){if(this!==n.target&&(/textarea|select/i.test(n.target.nodeName)||n.target.type==="text")){return}var h=n.type!=="keypress"&&jQuery.vakata_hotkeys.specialKeys[n.which],o=String.fromCharCode(n.which).toLowerCase(),k,m="",g={};if(n.altKey&&h!=="alt"){m+="alt+"}if(n.ctrlKey&&h!=="ctrl"){m+="ctrl+"}if(n.metaKey&&!n.ctrlKey&&h!=="meta"){m+="meta+"}if(n.shiftKey&&h!=="shift"){m+="shift+"}if(h){g[m+h]=true}else{g[m+o]=true;g[m+jQuery.vakata_hotkeys.shiftNums[o]]=true;if(m==="shift+"){g[jQuery.vakata_hotkeys.shiftNums[o]]=true}}for(var j=0,f=e.length;j<f;j++){if(g[e[j]]){return c.apply(this,arguments)}}}}jQuery.each(["keydown","keyup","keypress"],function(){jQuery.event.special[this]={add:b}})})(jQuery)}(function(b){var c=false,a={element:false,reference:false,position_x:0,position_y:0,items:[],html:"",is_visible:false};b.vakata.context={settings:{hide_onmouseleave:0,icons:true},_trigger:function(d){b(document).triggerHandler("context_"+d+".vakata",{reference:a.reference,element:a.element,position:{x:a.position_x,y:a.position_y}})},_execute:function(d){d=a.items[d];return d&&!d._disabled&&d.action?d.action.call(null,{item:d,reference:a.reference,element:a.element,position:{x:a.position_x,y:a.position_y}}):false},_parse:function(h,f){if(!h){return false}if(!f){a.html="";a.items=[]}var g="",d=false,e;if(f){g+="<ul>"}b.each(h,function(j,k){if(!k){return true}a.items.push(k);if(!d&&k.separator_before){g+="<li class='vakata-context-separator'><a href='#' "+(b.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"}d=false;g+="<li class='"+(k._class||"")+(k._disabled?" vakata-contextmenu-disabled ":"")+"'>";g+="<a href='#' rel='"+(a.items.length-1)+"'>";if(b.vakata.context.settings.icons){g+="<ins ";if(k.icon){if(k.icon.indexOf("/")!==-1){g+=" style='background:url(\""+k.icon+"\") center center no-repeat' "}else{g+=" class='"+k.icon+"' "}}g+=">&#160;</ins><span>&#160;</span>"}g+=k.label+"</a>";if(k.submenu){e=b.vakata.context._parse(k.submenu,true);if(e){g+=e}}g+="</li>";if(k.separator_after){g+="<li class='vakata-context-separator'><a href='#' "+(b.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>";d=true}});g=g.replace(/<li class\='vakata-context-separator'\><\/li\>$/,"");if(f){g+="</ul>"}if(!f){a.html=g;b.vakata.context._trigger("parse")}return g.length>10?g:false},_show_submenu:function(l){l=b(l);if(!l.length||!l.children("ul").length){return}var k=l.children("ul"),d=l.offset().left+l.outerWidth(),m=l.offset().top,f=k.width(),i=k.height(),g=b(window).width()+b(window).scrollLeft(),j=b(window).height()+b(window).scrollTop();if(c){l[d-(f+10+l.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left")}else{l[d+f+10>g?"addClass":"removeClass"]("vakata-context-right")}if(m+i+10>j){k.css("bottom","-1px")}k.show()},show:function(g,k,i){if(a.element&&a.element.length){a.element.width("")}switch(!0){case (!k&&!g):return false;case (!!k&&!!g):a.reference=g;a.position_x=k.x;a.position_y=k.y;break;case (!k&&!!g):a.reference=g;var f=g.offset();a.position_x=f.left+g.outerHeight();a.position_y=f.top;break;case (!!k&&!g):a.position_x=k.x;a.position_y=k.y;break}if(!!g&&!i&&b(g).data("vakata_contextmenu")){i=b(g).data("vakata_contextmenu")}if(b.vakata.context._parse(i)){a.element.html(a.html)}if(a.items.length){var l=a.element,p=a.position_x,n=a.position_y,q=l.width(),j=l.height(),d=b(window).width()+b(window).scrollLeft(),m=b(window).height()+b(window).scrollTop();if(c){p-=l.outerWidth();if(p<b(window).scrollLeft()+20){p=b(window).scrollLeft()+20}}if(p+q+20>d){p=d-(q+20)}if(n+j+20>m){n=m-(j+20)}a.element.css({left:p,top:n}).show().width(a.element.outerWidth());a.is_visible=true;b.vakata.context._trigger("show")}},hide:function(){if(a.is_visible){a.element.hide().find("ul").hide();a.is_visible=false;b.vakata.context._trigger("hide")}}};b(function(){c=b("body").css("direction")==="rtl";var e=false,d='.vakata-context { display:none; _width:1px; } .vakata-context, .vakata-context ul { margin:0; padding:2px; position:absolute; background:#f5f5f5; border:1px solid #979797; 	-moz-box-shadow:5px 5px 4px -4px #666666; -webkit-box-shadow:2px 2px 2px #999999; box-shadow:2px 2px 2px #999999; }.vakata-context ul { list-style:none; left:100%; margin-top:-2.7em; margin-left:-4px; } .vakata-context li.vakata-context-right ul { left:auto; right:100%; margin-left:auto; margin-right:-4px; } .vakata-context li { list-style:none; display:inline; }.vakata-context li a { display:block; padding:0 2em 0 2em; text-decoration:none; width:auto; color:black; white-space:nowrap; line-height:2.4em; 	-moz-text-shadow:1px 1px 0px white; -webkit-text-shadow:1px 1px 0px white; text-shadow:1px 1px 0px white; 	-moz-border-radius:1px; -webkit-border-radius:1px; border-radius:1px; }.vakata-context li a:hover { position:relative; background-color:#e8eff7; 	-moz-box-shadow:0px 0px 2px #0a6aa1; -webkit-box-shadow:0px 0px 2px #0a6aa1; box-shadow:0px 0px 2px #0a6aa1; }.vakata-context li.vakata-context-hover > a { position:relative; background-color:#e8eff7; 	-moz-box-shadow:0px 0px 2px #0a6aa1; -webkit-box-shadow:0px 0px 2px #0a6aa1; box-shadow:0px 0px 2px #0a6aa1; }.vakata-context li a.vakata-context-parent { background-image:url("data:image/gif;base64,R0lGODlhCwAHAIAAACgoKP///yH5BAEAAAEALAAAAAALAAcAAAIORI4JlrqN1oMSnmmZDQUAOw=="); background-position:right center; background-repeat:no-repeat; } .vakata-context li.vakata-context-separator a, .vakata-context li.vakata-context-separator a:hover { background:white; border:0; border-top:1px solid #e2e3e3; height:1px; min-height:1px; max-height:1px; padding:0; margin:0 0 0 2.4em; border-left:1px solid #e0e0e0; _overflow:hidden; 	-moz-text-shadow:0 0 0 transparent; -webkit-text-shadow:0 0 0 transparent; text-shadow:0 0 0 transparent; 	-moz-box-shadow:0 0 0 transparent; -webkit-box-shadow:0 0 0 transparent; box-shadow:0 0 0 transparent; 	-moz-border-radius:0; -webkit-border-radius:0; border-radius:0; }.vakata-context li.vakata-contextmenu-disabled a, .vakata-context li.vakata-contextmenu-disabled a:hover { color:silver; background-color:transparent; border:0; box-shadow:0 0 0; }.vakata-context li a ins { text-decoration:none; display:inline-block; width:2.4em; height:2.4em; background:transparent; margin:0 0 0 -2em; } .vakata-context li a span { display:inline-block; width:1px; height:2.4em; background:white; margin:0 0.5em 0 0; border-left:1px solid #e2e3e3; _overflow:hidden; } .vakata-context-rtl ul { left:auto; right:100%; margin-left:auto; margin-right:-4px; } .vakata-context-rtl li a.vakata-context-parent { background-image:url("data:image/gif;base64,R0lGODlhCwAHAIAAACgoKP///yH5BAEAAAEALAAAAAALAAcAAAINjI+AC7rWHIsPtmoxLAA7"); background-position:left center; background-repeat:no-repeat; } .vakata-context-rtl li.vakata-context-separator a { margin:0 2.4em 0 0; border-left:0; border-right:1px solid #e2e3e3;} .vakata-context-rtl li.vakata-context-left ul { right:auto; left:100%; margin-left:-4px; margin-right:auto; } .vakata-context-rtl li a ins { margin:0 -2em 0 0; } .vakata-context-rtl li a span { margin:0 0 0 0.5em; border-left-color:white; background:#e2e3e3; } ';b.vakata.css.add_sheet({str:d,title:"vakata-context"});a.element=b("<ul class='vakata-context'></ul>");a.element.delegate("li","mouseenter",function(f){f.stopImmediatePropagation();if(b.contains(this,f.relatedTarget)){return}if(e){clearTimeout(e)}a.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end();b(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").andSelf().addClass("vakata-context-hover");b.vakata.context._show_submenu(this)}).delegate("li","mouseleave",function(f){if(b.contains(this,f.relatedTarget)){return}b(this).find(".vakata-context-hover").andSelf().removeClass("vakata-context-hover")}).bind("mouseleave",function(f){b(this).find(".vakata-context-hover").removeClass("vakata-context-hover");if(b.vakata.context.settings.hide_onmouseleave){e=setTimeout((function(g){return function(){b.vakata.context.hide()}})(this),b.vakata.context.settings.hide_onmouseleave)}}).delegate("a","click",function(f){f.preventDefault()}).delegate("a","mouseup",function(f){if(!b(this).blur().parent().hasClass("vakata-context-disabled")&&b.vakata.context._execute(b(this).attr("rel"))!==false){b.vakata.context.hide()}}).appendTo("body");b(document).bind("mousedown",function(f){if(a.is_visible&&!b.contains(a.element[0],f.target)){b.vakata.context.hide()}}).bind("context_show.vakata",function(g,f){a.element.find("li:has(ul)").children("a").addClass("vakata-context-parent");if(c){a.element.addClass("vakata-context-rtl").css("direction","rtl")}a.element.find("ul").hide().end()});if(typeof b.hotkeys!=="undefined"||typeof b.vakata_hotkeys!=="undefined"){b(document).bind("keydown","up",function(f){if(a.is_visible){var g=a.element.find("ul:visible").andSelf().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first();if(!g.length){g=a.element.find("ul:visible").andSelf().last().children("li:not(.vakata-context-separator)").last()}g.addClass("vakata-context-hover");f.stopImmediatePropagation();f.preventDefault()}}).bind("keydown","down",function(f){if(a.is_visible){var g=a.element.find("ul:visible").andSelf().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first();if(!g.length){g=a.element.find("ul:visible").andSelf().last().children("li:not(.vakata-context-separator)").first()}g.addClass("vakata-context-hover");f.stopImmediatePropagation();f.preventDefault()}}).bind("keydown","right",function(f){if(a.is_visible){a.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover");f.stopImmediatePropagation();f.preventDefault()}}).bind("keydown","left",function(f){if(a.is_visible){a.element.find(".vakata-context-hover").last().parents("li:eq(0)").find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover");f.stopImmediatePropagation();f.preventDefault()}}).bind("keydown","esc",function(f){b.vakata.context.hide();f.preventDefault()}).bind("keydown","space",function(f){a.element.find(".vakata-context-hover").last().children("a").click();f.preventDefault()})}})})(jQuery);(function(a){var b=function(e){var c=/["\\\x00-\x1f\x7f-\x9f]/g,d={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};if(e.match(c)){return'"'+e.replace(c,function(f){var g=d[f];if(typeof g==="string"){return g}g=f.charCodeAt();return"\\u00"+Math.floor(g/16).toString(16)+(g%16).toString(16)})+'"'}return'"'+e+'"'};a.vakata.json={encode:function(e){if(e===null){return"null"}var d=[],c;switch(typeof(e)){case"undefined":return undefined;case"number":case"boolean":return e+"";case"string":return b(e);case"object":if(a.isFunction(e.toJSON)){return a.vakata.json.encode(e.toJSON())}if(e.constructor===Date){return'"'+e.getUTCFullYear()+"-"+String("0"+(e.getUTCMonth()+1)).slice(-2)+"-"+String("0"+e.getUTCDate()).slice(-2)+"T"+String("0"+e.getUTCHours()).slice(-2)+":"+String("0"+e.getUTCMinutes()).slice(-2)+":"+String("0"+e.getUTCSeconds()).slice(-2)+"."+String("00"+e.getUTCMilliseconds()).slice(-3)+'Z"'}if(e.constructor===Array){for(c=0;c<e.length;c++){d.push(a.vakata.json.encode(e[c])||"null")}return"["+d.join(",")+"]"}a.each(e,function(g,f){if(a.isFunction(f)){return true}g=typeof g==="number"?'"'+g+'"':b(g);f=a.vakata.json.encode(f);d.push(g+":"+f)});return"{"+d.join(", ")+"}"}},decode:function(c){return a.parseJSON(c)}}})(jQuery);(function(a){a.vakata.cookie=function(e,f,c){var h,d,b,g;if(arguments.length>1&&String(f)!=="[object Object]"){c=a.extend({},c);if(f===null||f===undefined){c.expires=-1}if(typeof c.expires==="number"){h=c.expires;d=c.expires=new Date();d.setDate(d.getDate()+h)}f=String(f);return(document.cookie=[encodeURIComponent(e),"=",c.raw?f:encodeURIComponent(f),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join(""))}c=f||{};g=c.raw?function(i){return i}:decodeURIComponent;return(b=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?g(b[1]):null}})(jQuery);(function(f){var g={},d={jStorage:"{}"},h=null,j=0,m=f.vakata.json.encode,e=f.vakata.json.decode,i=false,l=false;function k(){var o=false;if("localStorage" in window){try{window.localStorage.setItem("_tmptest","tmpval");o=true;window.localStorage.removeItem("_tmptest")}catch(p){}}if(o){try{if(window.localStorage){d=window.localStorage;i="localStorage"}}catch(t){}}else{if("globalStorage" in window){try{if(window.globalStorage){d=window.globalStorage[window.location.hostname];i="globalStorage"}}catch(s){}}else{h=document.createElement("link");if(h.addBehavior){h.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(h);try{h.load("jStorage");var r="{}";r=h.getAttribute("jStorage");d.jStorage=r;i="userDataBehavior"}catch(q){}}if(!i&&(!!f.vakata.cookie("__vjstorage")||(f.vakata.cookie("__vjstorage","{}",{expires:365})&&f.vakata.cookie("__vjstorage")==="{}"))){h=null;d.jStorage=f.vakata.cookie("__vjstorage");i="cookie"}if(!i){h=null;return}}}b();n()}function b(){if(d.jStorage){try{g=e(String(d.jStorage))}catch(o){d.jStorage="{}"}}else{d.jStorage="{}"}j=d.jStorage?String(d.jStorage).length:0}function c(){try{d.jStorage=m(g);if(i==="userDataBehavior"){h.setAttribute("jStorage",d.jStorage);h.save("jStorage")}if(i==="cookie"){f.vakata.cookie("__vjstorage",d.jStorage,{expires:365})}j=d.jStorage?String(d.jStorage).length:0}catch(o){}}function a(o){if(!o||(typeof o!=="string"&&typeof o!=="number")){throw new TypeError("Key name must be string or numeric")}if(o==="__jstorage_meta"){throw new TypeError("Reserved key name")}return true}function n(){var s=+new Date(),o,q,p=Infinity,r=false;if(l!==false){clearTimeout(l)}if(!g.__jstorage_meta||typeof g.__jstorage_meta.TTL!=="object"){return}q=g.__jstorage_meta.TTL;for(o in q){if(q.hasOwnProperty(o)){if(q[o]<=s){delete q[o];delete g[o];r=true}else{if(q[o]<p){p=q[o]}}}}if(p!==Infinity){l=setTimeout(n,p-s)}if(r){c()}}f.vakata.storage={version:"0.1.6.1",set:function(o,p){a(o);g[o]=p;c();return p},get:function(o,p){a(o);if(o in g){return g[o]}return typeof(p)==="undefined"?null:p},del:function(o){a(o);if(o in g){delete g[o];if(g.__jstorage_meta&&typeof g.__jstorage_meta.TTL==="object"&&o in g.__jstorage_meta.TTL){delete g.__jstorage_meta.TTL[o]}c();return true}return false},setTTL:function(p,o){var q=+new Date();a(p);o=Number(o)||0;if(p in g){if(!g.__jstorage_meta){g.__jstorage_meta={}}if(!g.__jstorage_meta.TTL){g.__jstorage_meta.TTL={}}if(o>0){g.__jstorage_meta.TTL[p]=q+o}else{delete g.__jstorage_meta.TTL[p]}c();n();return true}return false},flush:function(){g={};c();return true},storageObj:function(){function o(){}o.prototype=g;return new o()},index:function(){var o=[],p;f.each(g,function(r,q){if(r!=="__jstorage_meta"){o.push(r)}});return o},storageSize:function(){return j},currentBackend:function(){return i},storageAvailable:function(){return !!i}};k()})(jQuery);(function(a){a.vakata.pretty_date={lang:{ago:"Ago",from:"From Now",now:"Just Now",minute:"Minute",minutes:"Minutes",hour:"Hour",hours:"Hours",day:"Day",days:"Days",week:"Week",weeks:"Weeks",month:"Month",months:"Months",year:"Year",years:"Years"},parse:function(e,c){e=new Date(e.replace(/-/g,"/").replace(/[TZ]/g," ").replace(/\+\d\d\:\d\d$/,""));c=c||new Date();var b=a.vakata.pretty_date.lang,j=[[60,b.now],[3600,b.minute,b.minutes,60],[86400,b.hour,b.hours,3600],[604800,b.day,b.days,86400],[2628000,b.week,b.weeks,604800],[31536000,b.month,b.months,2628000],[Infinity,b.year,b.years,31536000]],l=(c-e+c.getTimezoneOffset()*60000)/1000,h=function(m,n){var i=0.1;if(m>=n&&m<=n*(1+i)){return n}return m},f;if(l<0){l=Math.abs(l);f=" "+b.from}else{f=" "+b.ago}for(var g=0,k=j[0];j[g];k=j[++g]){if(l<k[0]){if(g===0){return k[1]}var d=Math.ceil(h(l,k[3])/(k[3]));return d+" "+(d!==1?k[2]:k[1])+(g>0?f:"")}}},init:function(b,c){a("time, [datetime]").vakata_pretty_date(c);setInterval(function(){a("time, [datetime]").vakata_pretty_date(c)},b||60000)}};a.fn.vakata_pretty_date=function(c,b){if(!c){c="%{s}"}return this.each(function(){var e=jQuery(this),d=a.vakata.pretty_date.parse(e.attr("datetime"),b);if(d){d=c.replace("%{s}",d);if(e.html()!==d){e.html(d)}}})}})(jQuery);(function(a){a.vakata.selection={get:function(d){if(window.getSelection){if(d){return window.getSelection().toString()}var b=window.getSelection(),c=b.getRangeAt&&b.rangeCount?b.getRangeAt(0):document.createRange(),e=document.createElement("div");if(!b.getRangeAt){c.setStart(b.anchorNode,b.anchorOffset);c.setEnd(b.focusNode,b.focusOffset)}e.appendChild(c.cloneContents());return e.innerHTML}if(document.selection){return document.selection.createRange()[d?"text":"htmlText"]}return""},elm_get:function(h){h=typeof h==="string"?document.getElementById(h):h;if(h.jquery){h=h.get(0)}if("selectionStart" in h){return{start:h.selectionStart,end:h.selectionEnd,length:(h.selectionEnd-h.selectionStart),text:h.value.substr(h.selectionStart,(h.selectionEnd-h.selectionStart))}}else{if(document.selection){h.focus();var d=document.selection.createRange(),c=false,j=false,b,f,g,i;if(d&&d.parentElement()===h){b=h.value.length;f=h.value.replace(/\r\n/g,"\n");c=h.createTextRange();c.moveToBookmark(d.getBookmark());j=h.createTextRange();j.collapse(false);if(c.compareEndPoints("StartToEnd",j)>-1){g=i=b}else{g=-c.moveStart("character",-b);g+=f.slice(0,g).split("\n").length-1;if(c.compareEndPoints("EndToEnd",j)>-1){i=b}else{i=-c.moveEnd("character",-b);i+=f.slice(0,i).split("\n").length-1}}f=h.value.slice(g,i);return{start:g,end:i,length:f.length,text:f}}}else{return{start:h.value.length,end:h.value.length,length:0,text:""}}}},elm_set:function(g,d,c){g=typeof g==="string"?document.getElementById(g):g;if(g.jquery){g=g.get(0)}if("selectionStart" in g){g.focus();g.selectionStart=d;g.selectionEnd=c}else{if(document.selection){g.focus();var f=g.createTextRange(),b=g.value.replace(/\r\n/g,"\n");d-=b.slice(0,d).split("\n").length-1;c-=b.slice(0,c).split("\n").length-1;f.collapse(true);f.moveEnd("character",c);f.moveStart("character",d);f.select()}}return a.vakata.selection.elm_get(g)},elm_replace:function(g,d){g=typeof g==="string"?document.getElementById(g):g;if(g.jquery){g=g.get(0)}var f=a.vakata.selection.elm_get(g),c=f.start,b=c+d.length;g.value=g.value.substr(0,c)+d+g.value.substr(f.end,g.value.length);a.vakata.selection.elm_set(g,c,b);return{start:c,end:b,length:d.length,text:d}},elm_get_caret:function(b){return a.vakata.selection.elm_get(b).end},elm_set_caret:function(b,c){return a.vakata.selection.elm_set(b,c,c)},elm_get_caret_position:function(j){j=typeof j==="string"?document.getElementById(j):j;if(j.jquery){j=j.get(0)}var i=a.vakata.selection.elm_get_caret(j),g=j.value.substring(0,i).replace(/&/g,"&amp;").replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\r/g,"").replace(/\t/g,"&#10;").replace(/\n/ig,"<br />"),c=a.vakata.get_scrollbar_width(),d=a(j).width(),f=a(j).height();if(j.scrollHeight>f){d-=c}if(j.scrollWidth>d){f-=c}j=a(j);j=a("<div />").html(g).css({background:"red",width:d+"px",height:"auto",position:"absolute",left:"0px",top:"-10000px",fontSize:j.css("fontSize"),fontFamily:j.css("fontFamily"),fontWeight:j.css("fontWeight"),fontVariant:j.css("fontVariant"),fontStyle:j.css("fontStyle"),textTransform:j.css("textTransform"),lineHeight:j.css("lineHeight"),whiteSpace:"pre-wrap"});j.append('<span class="caret">&nbsp;</span>').appendTo("body");g=j.find("span.caret");i=g.offset();i.top=i.top+10000+g.height();j.remove();return i}}})(jQuery);(function(a){a.fn.vakata_highlight=function(b){var c=this;if(typeof b==="string"){b=[b]}if(a.isArray(b)){b={words:b}}b=a.extend(true,{},{css_class:"vakata-highlight",words:[],color:"#99ccff"},b);if(b.words.length){this.each(function(){var d=a(this);a.each(b.words,function(g,f){var e=false;if(typeof b.color==="string"){e=b.color}if(a.isArray(b.color)&&typeof b.color[g]==="string"){e=b.color[g]}d.find(':vakata_icontains("'+f.replace(/\"/ig,"")+'")').filter("strong, span, li, p, h1, h2, h3, h4, h5, h6, div, u, em, i, dt, dd").contents().filter(function(){return this.nodeType===3}).each(function(){if(this.nodeValue.toLowerCase().indexOf(f.toLowerCase())>=0){this.nodeValue=this.nodeValue.replace(new RegExp("("+f.replace(/([\-.*+?\^${}()|\[\]\/\\])/g,"\\$1")+")","ig"),"|{{{$1}}}|");var h=a(this).parent();h.html(h.html().replace(/\|\{\{\{/g,'<span class="'+b.css_class+" "+b.css_class+"-"+g+'" '+(typeof e==="string"?' style="background:'+e+';" ':"")+">").replace(/\}\}\}\|/g,"</span>"))}})})})}return c}})(jQuery);(function(){if(!jQuery){throw"jsTree: jQuery not included."}if(jQuery.jstree){return}(function(c){var e=[],b=-1,a={},d={};c.jstree={VERSION:"1.0.0",IS_IE6:(jQuery.browser.msie&&parseInt(jQuery.browser.version,10)===6),IS_IE7:(jQuery.browser.msie&&parseInt(jQuery.browser.version,10)===6),IS_FF2:(jQuery.browser.mozilla&&parseFloat(jQuery.browser.version,10)<1.9),__construct:function(f){var j={},l={},k=[],h=[],g=0;f=c(f);if(c.jstree._reference(f)){c.jstree.__destruct(f)}c.extend.apply(null,[true,j].concat(Array.prototype.slice.call(arguments,1),(f.data("jstree")||{})));k=c.isArray(j.plugins)?j.plugins:c.jstree.defaults.plugins.slice();k=c.vakata.array_unique(k);j=c.extend(true,{},c.jstree.defaults,j);c.each(a,function(m,n){if(m!=="core"&&c.inArray(m,k)===-1){j[m]=null;delete j[m]}else{h.push(m);l[m]={}}});j.plugins=h;g=parseInt(e.push({}),10)-1;f.data("jstree_instance_id",g).addClass("jstree jstree-"+g);this.data=l;this.get_index=function(){return g};this.get_container=function(){return f};this.get_container_ul=function(){return f.children("ul:eq(0)")};this.get_settings=function(i){return i?j:c.extend(true,{},j)};this.__trigger=function(i,m){if(!i){return}if(!m){m={}}if(typeof i==="string"){i=i.replace(".jstree","")+".jstree"}m.inst=this;this.get_container().triggerHandler(i,m)};e[g]=this;c.each(h,function(i,m){if(a[m]){a[m].__construct.apply(e[g])}});this.__trigger("__construct");c.jstree._focus(g);return this},__destruct:function(f){f=c.jstree._reference(f);if(!f){return false}var h=f.get_settings(),j=f.get_index(),g=0;if(b===j){for(g in e){if(e.hasOwnProperty(g)&&g!==j){c.jstree._focus(g);break}}if(b===j){c.jstree._focus(false)}}c.each(h.plugins,function(k,m){try{a[m].__destruct.apply(f)}catch(l){}});f.__trigger("__destruct");f.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});c(document).unbind(".jstree-"+j).undelegate(".jstree-"+j);delete e[j];return true},__call:function(f,g,h){f=c.jstree._reference(f);if(!f||!c.isFunction(f[g])){return}return f[g].apply(f,h)},_reference:function(f){if(e[f]){return e[f]}var g=c(f);if(!g.length&&typeof f==="string"){g=c("#"+f)}if(!g.length){return null}return e[g.closest(".jstree").data("jstree_instance_id")]||null},_focused:function(){return e[b]||null},_focus:function(f){if(f===false){e[b].get_container().removeClass("jstree-focused");e[b].__trigger("_defocus");b=-1;return false}f=c.jstree._reference(f);if(!f||f.get_index()===b){return false}if(b!==-1){e[b].get_container().removeClass("jstree-focused");e[b].__trigger("_defocus")}b=f.get_index();f.get_container().addClass("jstree-focused");f.__trigger("_focus");return true},plugin:function(f,g){g=c.extend({},{__construct:c.noop,__destuct:c.noop,_fn:{},defaults:false},g);a[f]=g;c.jstree.defaults[f]=g.defaults;c.each(g._fn,function(h,j){j.plugin=f;j.old=d[h];d[h]=function(){var i,l=j,k=Array.prototype.slice.call(arguments),n=new c.Event("before.jstree"),m=this.get_settings(true).plugins;do{if(l&&l.plugin&&c.inArray(l.plugin,m)!==-1){break}l=l.old}while(l);if(!l){return}if(h.indexOf("_")===0){i=l.apply(this,k)}else{i=this.__trigger(n,{func:h,args:k,plugin:l.plugin});if(i===false){return}i=l.apply(c.extend({},this,{__callback:function(o){this.__trigger(h,{args:k,rslt:o,plugin:l.plugin});return o},__call_old:function(o){return l.old.apply(this,(o?Array.prototype.slice.call(arguments,1):k))}}),k)}return i};d[h].old=j.old;d[h].plugin=f})},defaults:{plugins:[]}};c.fn.jstree=function(g){var f=(typeof g==="string"),h=Array.prototype.slice.call(arguments,1),i=this;this.each(function(){if(f){var j=c.jstree.__call(this,g,h);if(typeof j!=="undefined"&&(g.indexOf("is_"===0)||(j!==true&&j!==false))){i=j;return false}}else{f=new c.jstree.__construct(this,g)}});return i};d=c.jstree.__construct.prototype;c.expr[":"].jstree=function(g,h,f){return typeof(c(g).data("jstree_instance_id"))!=="undefined"}})(jQuery);(function(c){var a=false,b=false;c(function(){c.jstree.SCROLLBAR_WIDTH=c.vakata.get_scrollbar_width()});c.jstree.plugin("core",{__construct:function(){this.data.core.rtl=(this.get_container().css("direction")==="rtl");if(this.data.core.rtl){this.get_container().addClass("jstree-rtl")}this.data.core.ready=false;this.get_container().bind("__construct.jstree",c.proxy(function(){setTimeout(c.proxy(function(){if(this){this.init()}},this),0)},this)).bind("before.jstree",c.proxy(function(f,d){if(!/^is_locked|unlock$/.test(d.func)&&this.data.core.locked){f.stopImmediatePropagation();return false}},this)).bind("create_node.jstree",c.proxy(function(f,d){this.clean_node(d.rslt.obj)},this)).bind("load_node.jstree",c.proxy(function(f,d){this.clean_node(d.rslt.obj===-1?this.get_container_ul().children("li"):d.rslt.obj.find("> ul > li"));if(!this.data.core.ready&&!this.get_container_ul().find(".jstree-loading:eq(0)").length){this.data.core.ready=true;this.__trigger("__ready")}},this)).bind("__loaded.jstree",c.proxy(function(f,d){d.inst.get_container_ul().children("li").each(function(){d.inst.correct_node(this)})},this)).bind("open_node.jstree",c.proxy(function(f,d){d.rslt.obj.find("> ul > li").each(function(){d.inst.correct_node(this)})},this)).bind("mousedown.jstree",c.proxy(function(){c.jstree._focus(this.get_index())},this)).bind("dblclick.jstree",function(){if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){var d=window.getSelection();try{d.removeAllRanges();d.collapse()}catch(e){}}}}).delegate("li > ins","click.jstree",c.proxy(function(d){this.toggle_node(d.target)},this))},__destruct:function(){},defaults:{strings:false},_fn:{_get_string:function(e){var d=this.get_settings(true).core.strings;if(c.isFunction(d)){return d.call(this,e)}if(d&&d[e]){return d[e]}return e},init:function(){this.data.core.original_container_html=this.get_container().find(" > ul > li").clone(true);this.data.core.original_container_html.find("li").andSelf().contents().filter(function(){return this.nodeType===3&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove();this.get_container().html("<ul><li class='jstree-loading'><a href='#'>"+this._get_string("Loading ...")+"</a></li></ul>");this.clean_node(-1);this.data.core.li_height=this.get_container_ul().children("li:eq(0)").height()||18;this.load_node(-1,function(){this.__trigger("__loaded")})},lock:function(){this.data.core.locked=true;this.get_container().addClass("jstree-locked");this.__callback()},unlock:function(){this.data.core.locked=false;this.get_container().removeClass("jstree-locked");this.__callback()},is_locked:function(){return this.data.core.locked},get_node:function(d){var e=c(d,this.get_container());if(e.is(".jstree")||d===-1){return -1}e=e.closest("li",this.get_container());return e.length?e:false},get_next:function(e,d){e=this.get_node(e);if(e===-1){return this.get_container_ul().children("li:eq(0)")}if(!e||!e.length){return false}if(d){return(e.nextAll("li").size()>0)?e.nextAll("li:eq(0)"):false}if(e.hasClass("jstree-open")){return e.find("li:eq(0)")}else{if(e.nextAll("li").size()>0){return e.nextAll("li:eq(0)")}else{return e.parentsUntil(".jstree","li").next("li").eq(0)}}},get_prev:function(e,d){e=this.get_node(e);if(e===-1){return this.get_container().find("> ul > li:last-child")}if(!e||!e.length){return false}if(d){return(e.prevAll("li").length>0)?e.prevAll("li:eq(0)"):false}if(e.prev("li").length){e=e.prev("li").eq(0);while(e.hasClass("jstree-open")){e=e.children("ul:eq(0)").children("li:last")}return e}else{var f=e.parentsUntil(".jstree","li:eq(0)");return f.length?f:false}},get_parent:function(d){d=this.get_node(d);if(d===-1||!d||!d.length){return false}var e=d.parentsUntil(".jstree","li:eq(0)");return e.length?e:-1},get_children:function(d){d=this.get_node(d);if(d===-1){return this.get_container_ul().children("li")}if(!d||!d.length){return false}return d.find("> ul > li")},is_parent:function(d){d=this.get_node(d);return d&&d!==-1&&(d.find("> ul > li:eq(0)").length||d.hasClass("jstree-closed"))},is_loaded:function(d){d=this.get_node(d);return d&&((d===-1&&!this.get_container().find("> ul > li.jstree-loading").length)||(d!==-1&&!d.hasClass("jstree-loading")&&(d.find("> ul > li").length||d.hasClass("jstree-leaf"))))},is_loading:function(d){d=this.get_node(d);return d&&((d===-1&&this.get_container().find("> ul > li.jstree-loading").length)||(d!==-1&&d.hasClass("jstree-loading")))},is_open:function(d){d=this.get_node(d);return d&&d!==-1&&d.hasClass("jstree-open")},is_closed:function(d){d=this.get_node(d);return d&&d!==-1&&d.hasClass("jstree-closed")},is_leaf:function(d){d=this.get_node(d);return d&&d!==-1&&d.hasClass("jstree-leaf")},load_node:function(d,e){d=this.get_node(d);if(!d){e.call(this,d,false);return false}if(d!==-1){d.addClass("jstree-loading")}this._load_node(d,c.proxy(function(f){if(d!==-1){d.removeClass("jstree-loading")}this.__callback({obj:d,status:f});if(e){e.call(this,d,f)}},this));return true},_load_node:function(d,e){if(d===-1){this.get_container_ul().empty().append(this.data.core.original_container_html.clone(true))}e.call(null,true)},open_node:function(f,g,e){f=this.get_node(f);if(f===-1||!f||!f.length){return false}if(!this.is_closed(f)){if(g){g.call(this,f,false)}return false}if(!this.is_loaded(f)){this.load_node(f,function(i,h){return h?this.open_node(i,g,e):g?g.call(this,i,false):false})}else{var d=this;f.children("ul").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").children("ul").stop(true,true).slideDown((c.jstree.IS_IE6?0:e),function(){this.style.display="";d.__trigger("__after_open",{rslt:{obj:f}})});if(g){g.call(this,f,true)}this.__callback({obj:f})}},close_node:function(f,e){f=this.get_node(f);if(!f||!f.length||!this.is_open(f)){return false}var d=this;f.children("ul").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").children("ul").stop(true,true).slideUp((c.jstree.IS_IE6?0:e),function(){this.style.display="";d.__trigger("__after_close",{rslt:{obj:f}})});this.__callback({obj:f})},toggle_node:function(d){if(this.is_closed(d)){return this.open_node(d)}if(this.is_open(d)){return this.close_node(d)}},open_all:function(f,e,d){f=f?this.get_node(f):-1;f=!f||f===-1?this.get_container_ul():f;d=d||f;var g=this;f=this.is_closed(f)?f.find("li.jstree-closed").andSelf():f.find("li.jstree-closed");f.each(function(){g.open_node(this,g.is_loaded(this)?false:function(h){this.open_all(h,e,d)},e||0)});if(d.find("li.jstree-closed").length===0){this.__callback({obj:d})}},close_all:function(e,d){e=e?this._get_node(e):-1;var g=!e||e===-1?this.get_container_ul():e,f=this;g=this.is_open(g)?g.find("li.jstree-open").andSelf():g.find("li.jstree-open");g.each(function(){f.close_node(this,d||0)});this.__callback({obj:e})},clean_node:function(d){d=this.get_node(d);d=!d||d===-1?this.get_container().find("li"):d.find("li").andSelf();var e=this;return d.each(function(){var f=c(this),h=f.data("jstree"),g=(h&&h.opened)||f.hasClass("jstree-open")?"open":(h&&h.closed)||f.children("ul").length?"closed":"leaf";if(h&&h.opened){delete h.opened}if(h&&h.closed){delete h.closed}f.removeClass("jstree-open jstree-closed jstree-leaf jstree-last");if(!f.children("a").length){f.contents().filter(function(){return this.nodeType===3||this.tagName!=="UL"}).wrapAll('<a href="#"></a>');f.children("a").html(f.children("a").html().replace(/[\s\t\n]+$/,""))}else{if(!c.trim(f.children("a").attr("href"))){f.children("a").attr("href","#")}}if(!f.children("ins.jstree-ocl").length){f.prepend("<ins class='jstree-icon jstree-ocl'>&#160;</ins>")}if(f.is(":last-child")){f.addClass("jstree-last")}switch(g){case"leaf":f.addClass("jstree-leaf");break;case"closed":f.addClass("jstree-open");e.close_node(f,0);break;case"open":f.addClass("jstree-closed");e.open_node(f,false,0);break}})},correct_node:function(e,d){e=this.get_node(e);if(!e||(e===-1&&!d)){return false}if(e===-1){e=this.get_container().find("li")}else{e=d?e.find("li").andSelf():e}e.each(function(){var f=c(this);switch(!0){case f.hasClass("jstree-open")&&!f.find("> ul > li").length:f.removeClass("jstree-open").addClass("jstree-leaf").children("ul").remove();break;case f.hasClass("jstree-leaf")&&!!f.find("> ul > li").length:f.removeClass("jstree-leaf").addClass("jstree-closed");break}f[f.is(":last-child")?"addClass":"removeClass"]("jstree-last")});return e},scroll_to_node:function(e){var f=this.get_container()[0],d;if(f.scrollHeight>f.offsetHeight){e=this.get_node(e);if(!e||e===-1||!e.length||!e.is(":visible")){return}d=e.offset().top-this.get_container().offset().top;if(d<0){f.scrollTop=f.scrollTop+d-1}if(d+this.data.core.li_height+(f.scrollWidth>f.offsetWidth?c.jstree.SCROLLBAR_WIDTH:0)>f.offsetHeight){f.scrollTop=f.scrollTop+(d-f.offsetHeight+this.data.core.li_height+1+(f.scrollWidth>f.offsetWidth?c.jstree.SCROLLBAR_WIDTH:0))}}},get_state:function(){var d={open:[],scroll:{left:this.get_container().scrollLeft(),top:this.get_container().scrollTop()}};this.get_container_ul().find(".jstree-open").each(function(){if(this.id){d.open.push(this.id)}});return d},set_state:function(f,g){if(f){if(c.isArray(f.open)){var e=true,d=this;c.each(f.open.concat([]),function(j,h){h=document.getElementById(h);if(h){if(d.is_loaded(h)){if(d.is_closed(h)){d.open_node(h,false,0)}c.vakata.array_remove(f.open,j)}else{if(!d.is_loading(h)){d.open_node(h,c.proxy(function(){this.set_state(f)},d),0)}e=false}}});if(e){delete f.open;this.set_state(f,g)}return false}if(f.scroll){if(f.scroll&&typeof f.scroll.left!=="undefined"){this.get_container().scrollLeft(f.scroll.left)}if(f.scroll&&typeof f.scroll.top!=="undefined"){this.get_container().scrollTop(f.scroll.top)}delete f.scroll;delete f.open;this.set_state(f,g);return false}if(c.isEmptyObject(f)){if(g){g.call(this)}this.__callback();return false}return true}return false},refresh:function(){this.data.core.state=this.get_state();this.load_node(-1,function(e,d){if(d){this.set_state(c.extend(true,{},this.data.core.state),function(){this.__trigger("refresh")})}this.data.core.state=null})},get_text:function(d,e){d=this.get_node(d);if(!d||d===-1||!d.length){return false}d=d.children("a:eq(0)").clone();d.children(".jstree-icon").remove();return d[e?"text":"html"]()},set_text:function(e,f){e=this.get_node(e);if(!e||e===-1||!e.length){return false}e=e.children("a:eq(0)");var d=e.children("INS").clone();e.html(f).prepend(d);this.__callback({obj:e,text:f});return true},parse_json:function(h){var d,e,g,f;if(c.isArray(h)){g=c("<ul />");f=this;c.each(h,function(k,j){g.append(f.parse_json(j))});return g}if(typeof h==="undefined"){h={}}if(typeof h==="string"){h={title:h}}if(!h.li_attr){h.li_attr={}}if(!h.a_attr){h.a_attr={}}if(!h.a_attr.href){h.a_attr.href="#"}if(!h.title){h.title=this._get_string("New node")}d=c("<li />").attr(h.li_attr);e=c("<a />").attr(h.a_attr).html(h.title);g=c("<ul />");if(h.data&&!c.isEmptyObject(h.data)){d.data(h.data)}if(h.children===true||c.isArray(h.children)||(d.data("jstree")&&c.isArray(d.data("jstree").children))){if(!d.data("jstree")){d.data("jstree",{})}d.data("jstree").closed=true}d.append(e);if(c.isArray(h.children)){c.each(h.children,c.proxy(function(j,k){g.append(this.parse_json(k))},this));d.append(g)}return d},get_json:function(j,h){j=typeof j!=="undefined"?this.get_node(j):false;if(!h){if(!j||j===-1){j=this.get_container_ul().children("li")}}var i,g,e={},d={},f={};if(!j||!j.length){return false}if(j.length>1||!h){i=[];g=this;j.each(function(){i.push(g.get_json(c(this),true))});return i}f=c.vakata.attributes(j,true);c.each(f,function(l,k){if(l==="id"){e[l]=k;return true}k=c.trim(k.replace(/\bjstree[^ ]*/ig,"").replace(/\s+$/ig," "));if(k.length){e[l]=k}});f=c.vakata.attributes(j.children("a"),true);c.each(f,function(l,k){if(l==="id"){d[l]=k;return true}k=c.trim(k.replace(/\bjstree[^ ]*/ig,"").replace(/\s+$/ig," "));if(k.length){d[l]=k}});i={title:this.get_text(j),data:c.extend(true,{},j.data()||{}),children:false,li_attr:e,a_attr:d};if(!i.data.jstree){i.data.jstree={}}if(this.is_open(j)){i.data.jstree.opened=true}if(this.is_closed(j)){i.data.jstree.closed=true}j=j.find("> ul > li");if(j.length){i.children=[];g=this;j.each(function(){i.children.push(g.get_json(c(this),true))})}return i},create_node:function(g,h,j,i,e){g=this.get_node(g);j=typeof j==="undefined"?"last":j;if(g!==-1&&!g.length){return false}if(!j.match(/^(before|after)$/)&&!e&&!this.is_loaded(g)){return this.load_node(g,function(){this.create_node(g,h,j,i,true)})}var d=this.parse_json(h),f=g===-1?this.get_container():g;if(g===-1){if(j==="before"){j="first"}if(j==="after"){j="last"}}switch(j){case"before":j=g.index();g=this.get_parent(g);break;case"after":j=g.index()+1;g=this.get_parent(g);break;case"inside":case"first":j=0;break;case"last":j=f.children("ul").children("li").length;break;default:if(!j){j=0}break}if(!this.check("create_node",d,g,j)){return false}f=g===-1?this.get_container():g;if(!f.children("ul").length){f.append("<ul />")}if(f.children("ul").children("li").eq(j).length){f.children("ul").children("li").eq(j).before(d)}else{f.children("ul").append(d)}this.correct_node(g,true);if(i){i.call(this,d)}this.__callback({obj:d,parent:g,position:d.index()});return d},rename_node:function(e,f){e=this.get_node(e);var d=this.get_text(e);if(!this.check("rename_node",e,this.get_parent(e),f)){return false}if(e&&e.length){this.set_text(e,f);this.__callback({obj:e,title:f,old:d})}},delete_node:function(f){f=this.get_node(f);if(!f||f===-1||!f.length){return false}var d=this.get_parent(f),e=this.get_prev(f);if(!this.check("delete_node",f,d,f.index())){return false}f=f.detach();this.correct_node(d);this.correct_node(e);this.__callback({obj:f,prev:e,parent:d});return f},check:function(d,g,f,h){var e=d.match(/^move_node|copy_node|create_node$/i)?f:g;e=e===-1?this.get_container().data("jstree"):e.data("jstree");if(e&&e.functions&&e.functions[d]){e=e.functions[d];if(c.isFunction(e)){e=e.call(this,d,g,f,h)}if(e===false){return false}}switch(d){case"create_node":break;case"rename_node":break;case"move_node":e=f===-1?this.get_container():f;e=e.children("ul").children("li");if(e.length&&e.index(g)!==-1&&(h===g.index()||h===g.index()+1)){return false}if(f!==-1&&f.parentsUntil(".jstree","li").andSelf().index(g)!==-1){return false}break;case"copy_node":break;case"delete_node":break}return true},move_node:function(f,i,k,l,j){f=this.get_node(f);i=this.get_node(i);k=typeof k==="undefined"?0:k;if(!f||f===-1||!f.length){return false}if(i!==-1&&!i.length){return false}if(!k.toString().match(/^(before|after)$/)&&!j&&!this.is_loaded(i)){return this.load_node(i,function(){this.move_node(f,i,k,l,true)})}var h=this.get_parent(f),d=(!k.toString().match(/^(before|after)$/)||i===-1)?i:this.get_parent(i),g=c.jstree._reference(f),m=i===-1?this:c.jstree._reference(i),e=(g.get_index()!==m.get_index());if(d===-1){i=m.get_container();if(k==="before"){k="first"}if(k==="after"){k="last"}}switch(k){case"before":k=i.index();break;case"after":k=i.index()+1;break;case"inside":case"first":k=0;break;case"last":k=i.children("ul").children("li").length;break;default:if(!k){k=0}break}if(!this.check("move_node",f,d,k)){return false}if(!i.children("ul").length){i.append("<ul />")}if(i.children("ul").children("li").eq(k).length){i.children("ul").children("li").eq(k).before(f)}else{i.children("ul").append(f)}if(e){f.find(".jstree-icon, .jstree-ocl").remove();this.clean_node(f)}g.correct_node(h,true);m.correct_node(d,true);if(l){l.call(this,f,d,f.index())}this.__callback({obj:f,parent:d,position:f.index(),old_parent:h,is_multi:e,old_instance:g,new_instance:m});return true},copy_node:function(f,i,k,l,j){f=this.get_node(f);i=this.get_node(i);k=typeof k==="undefined"?"last":k;if(!f||f===-1||!f.length){return false}if(i!==-1&&!i.length){return false}if(!k.toString().match(/^(before|after)$/)&&!j&&!this.is_loaded(i)){return this.load_node(i,function(){this.copy_node(f,i,k,l,true)})}var m=f,h=this.get_parent(f),d=(!k.toString().match(/^(before|after)$/)||i===-1)?i:this.get_parent(i),g=c.jstree._reference(f),n=i===-1?this:c.jstree._reference(i),e=(g.get_index()!==n.get_index());f=f.clone(true);f.find("*[id]").andSelf().each(function(){if(this.id){this.id="copy_"+this.id}});if(d===-1){i=n.get_container();if(k==="before"){k="first"}if(k==="after"){k="last"}}switch(k){case"before":k=i.index();break;case"after":k=i.index()+1;break;case"inside":case"first":k=0;break;case"last":k=i.children("ul").children("li").length;break;default:if(!k){k=0}break}if(!this.check("copy_node",m,d,k)){return false}if(!i.children("ul").length){i.append("<ul />")}if(i.children("ul").children("li").eq(k).length){i.children("ul").children("li").eq(k).before(f)}else{i.children("ul").append(f)}if(e){f.find(".jstree-icon, .jstree-ocl").remove()}n.clean_node(f);n.correct_node(d,true);if(l){l.call(this,f,d,f.index(),m)}this.__callback({obj:f,parent:d,old_parent:h,position:f.index(),original:m,is_multi:e,old_instance:g,new_instance:n});return true},cut:function(d){d=this.get_node(d);if(!d||d===-1||!d.length){return false}a=d;b="move_node";this.__callback({obj:d})},copy:function(d){d=this.get_node(d);if(!d||d===-1||!d.length){return false}a=d;b="copy_node";this.__callback({obj:d})},can_paste:function(){return b!==false&&a!==false},paste:function(d){d=this.get_node(d);if(!d||!b||!b.match(/^(copy_node|move_node)$/)||!a){return false}this[b](a,d);this.__callback({obj:d,nodes:a,mode:b});a=false;b=false},edit:function(e,l){e=this.get_node(e);if(!e||e===-1||!e.length){return false}e.parentsUntil(".jstree",".jstree-closed").each(c.proxy(function(r,q){this.open_node(q,false,0)},this));var k=this.data.core.rtl,o=this.get_container().width(),m=e.children("a:eq(0)"),n=e.children("ins"),i=m.children("ins"),f=n.width()*n.length,d=i.width()*i.length,p=typeof l==="string"?l:this.get_text(e),h=c("<div />",{css:{position:"absolute",top:"-200px",left:(k?"0px":"-1000px"),visibility:"hidden"}}).appendTo("body"),g=e.css("position","relative").append(c("<input />",{value:p,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:(k?"auto":(f+d+4)+"px"),right:(k?(f+d+4)+"px":"auto"),top:"0px",height:(this.data.core.li_height-2)+"px",lineHeight:(this.data.core.li_height-2)+"px",width:"150px"},blur:c.proxy(function(){var r=e.children(".jstree-rename-input"),q=r.val();if(q===""){q=p}h.remove();r.remove();this.rename_node(e,q);e.css("position","")},this),keyup:function(r){var q=r.keyCode||r.which;if(q===27){this.value=p;this.blur();return}else{if(q===13){this.blur();return}else{g.width(Math.min(h.text("pW"+this.value).width(),o))}}},keypress:function(r){var q=r.keyCode||r.which;if(q===13){return false}}})).children(".jstree-rename-input"),j={fontFamily:m.css("fontFamily")||"",fontSize:m.css("fontSize")||"",fontWeight:m.css("fontWeight")||"",fontStyle:m.css("fontStyle")||"",fontStretch:m.css("fontStretch")||"",fontVariant:m.css("fontVariant")||"",letterSpacing:m.css("letterSpacing")||"",wordSpacing:m.css("wordSpacing")||""};this.set_text(e,"");h.css(j);g.css(j).width(Math.min(h.text("pW"+g[0].value).width(),o))[0].select()},send_node:function(d){alert("Send")},share_node:function(d){alert("Share")}}});c(function(){var d=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree .jstree-icon { display:inline-block; text-decoration:none; margin:0; padding:0; vertical-align:top; } .jstree .jstree-ocl { width:18px; height:18px; text-align:center; line-height:18px; cursor:default; vertical-align:top; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";if(c.jstree.IS_IE6){try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}d+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } "}if(c.jstree.IS_IE7){d+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "}if(c.jstree.IS_FF2){d+=".jstree .jstree-icon { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } "}c.vakata.css.add_sheet({str:d,title:"jstree"})})})(jQuery)})();(function(a){a.jstree.plugin("checkbox",{__construct:function(){this.get_container().bind("__construct.jstree",a.proxy(function(){},this)).bind("move_node.jstree, copy_node.jstree",function(c,b){if(b.rslt.old_instance&&b.rslt.old_parent&&a.isFunction(b.rslt.old_instance.checkbox_repair)){b.rslt.old_instance.checkbox_repair(b.rslt.old_parent)}if(b.rslt.new_instance&&a.isFunction(b.rslt.new_instance.checkbox_repair)){b.rslt.new_instance.checkbox_repair(b.rslt.parent)}}).bind("delete_node.jstree",function(c,b){this.checkbox_repair(b.rslt.parent)}).delegate("a","click.jstree",a.proxy(function(c){c.preventDefault();c.currentTarget.blur();var b=this.get_node(c.currentTarget);this.toggle_check(b)},this))},defaults:{three_state:true},_fn:{check_node:function(b){b=this.get_node(b);b.find(" > a > .jstree-checkbox").removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked").children(":checkbox").prop("checked",true).prop("indeterminate",false);this.checkbox_repair(b);this.__callback({obj:b})},uncheck_node:function(b){b=this.get_node(b);b.find(" > a > .jstree-checkbox").removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",false).prop("indeterminate",false);this.checkbox_repair(b);this.__callback({obj:b})},toggle_check:function(b){b=b.find(" > a > .jstree-checkbox").removeClass("jstree-undetermined").toggleClass("jstree-checked");if(!b.hasClass("jstree-checked")){this.uncheck_node()}else{this.check_node()}},uncheck_all:function(c){var b=c?a(c).find(".jstree-checked").closest("li"):this.get_container().find(".jstree-checked").closest("li");b.children(".jstree-checkbox").removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked",false).prop("indeterminate",false);this.__callback({obj:b})},checkbox_repair:function(g){if(!this.get_settings(true).checkbox.three_state){return false}if(!g||g===-1){g=this.get_container_ul().children("li")}if(g.length>1){g.each(a.proxy(function(c,k){this.checkbox_repair(a(k))},this));return}var j=g.find(" > a > .jstree-checkbox"),i=true,f,e,h,b,d;if(!j.hasClass("jstree-checked")&&!j.hasClass("jstree-unchecked")){f=this.get_parent(g);if(f&&f!==-1&&f.length&&f.find("> a > .jstree-checked").length){j.addClass("jstree-checked")}else{j.addClass("jstree-unchecked")}i=false}if(j.hasClass("jstree-checked")){g.find(".jstree-checkbox").removeClass("jstree-undetermined jstree-unchecked").addClass("jstree-checked").children(":checkbox").prop("checked",true).prop("indeterminate",false)}if(j.hasClass("jstree-unchecked")){g.find(".jstree-checkbox").removeClass("jstree-undetermined jstree-checked").addClass("jstree-unchecked").children(":checkbox").prop("checked",false).prop("indeterminate",false)}while(i){g=this.get_parent(g);if(!g||g===-1||!g.length){return}e=g.find(" > ul > li");h=e.find(" > a > .jstree-checked").length;b=e.find(" > a > .jstree-unchecked").length;d=e.find(" > a > .jstree-undetermined").length;e=e.length;if(h+b+d<e){return}if(b===e){j=g.find(" > a > .jstree-checkbox");if(j.hasClass("jstree-unchecked")){return}j.removeClass("jstree-undetermined jstree-checked").addClass("jstree-unchecked").children(":checkbox").prop("checked",false).prop("indeterminate",false);continue}if(h===e){j=g.find(" > a > .jstree-checkbox");if(j.hasClass("jstree-checked")){return}j.removeClass("jstree-undetermined jstree-unchecked").addClass("jstree-checked").children(":checkbox").prop("checked",true).prop("indeterminate",false);continue}g.parentsUntil(".jstree","li").andSelf().find(" > a > .jstree-checkbox").removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined").children(":checkbox").prop("checked",false).prop("undetermined",true);return}},clean_node:function(c){c=this.__call_old();var b=this;c=c.each(function(){var f=a(this),e=f.data("jstree");f.find(" > a > .jstree-checkbox").remove();f.children("a").prepend("<ins class='jstree-icon jstree-checkbox "+(e&&e.checkbox&&e.checkbox.checked===true?"jstree-checked":"")+((e&&e.checkbox&&e.checkbox.checked===false)||!b.get_settings(true).checkbox.three_state?"jstree-unchecked":"")+" '><input class='jstree-check' type='checkbox' "+(e&&e.checkbox&&e.checkbox.checked?' checked="checked" ':"")+" name='"+(e&&e.checkbox&&typeof e.checkbox.name!=="undefined"?e.checkbox.name:"jstree[]")+"' value='"+(e&&e.checkbox&&typeof e.checkbox.value!=="undefined"?e.checkbox.value:f.attr("id"))+"' /></ins>")});b.checkbox_repair(c);return c},get_state:function(){var b=this.__call_old();b.checkbox=[];this.get_container().find(".jstree-checked").closest("li").each(function(){if(this.id){b.checkbox.push(this.id)}});return b},set_state:function(b,d){if(this.__call_old()){if(b.checkbox){var c=this;this.uncheck_all();a.each(b.checkbox,function(f,e){c.check_node(document.getElementById(e))});this.checkbox_repair();delete b.checkbox;this.set_state(b,d);return false}return true}return false},get_json:function(e,c){var d=this.__call_old(),b;if(c){b=e.find("> a > ins > :checkbox");d.data.jstree.checkbox={};d.data.jstree.checkbox.checked=b.parent().hasClass("jstree-checked");if(b.attr("name")!=="jstree[]"){d.data.checkbox.name=b.attr("name")}if(b.val()!==e.attr("id")){d.data.checkbox.value=b.val()}}return d}}});a(function(){var b=".jstree a > .jstree-checkbox { height:16px; width:16px; margin-right:1px; } .jstree-rtl a > .jstree-checkbox { margin-right:0; margin-left:1px; } .jstree .jstree-check { margin:0; padding:0; border:0; display:inline; vertical-align:text-bottom; } ";if(a.jstree.IS_IE6){b+=".jstree li a .jstree-checkbox { height:16px; width:16px; background:transparent; margin-right:1px; } .jstree-rtl li a .jstree-checkbox { margin-right:0; margin-left:1px; } "}a.vakata.css.add_sheet({str:b,title:"jstree"})});a.jstree.defaults.plugins.push("checkbox")})(jQuery);(function(a){a.jstree.plugin("contextmenu",{__construct:function(){this.get_container().delegate("a","contextmenu.jstree",a.proxy(function(b){b.preventDefault();if(!this.is_loading(b.currentTarget)){this.show_contextmenu(b.currentTarget,b.pageX,b.pageY)}},this)).delegate("a","click.jstree",a.proxy(function(b){if(this.data.contextmenu.visible){this._hide_contextmenu()}},this));a(document).bind("context_hide.vakata",a.proxy(function(){this.data.contextmenu=false},this))},__destruct:function(){if(this.data.contextmenu){this._hide_contextmenu()}},defaults:{select_node:true,show_at_node:true,incoming:function(b){return{create:{separator_before:false,separator_after:true,label:"Create",action:function(d){var c=a.jstree._reference(d.reference),e=c.get_node(d.reference);c.create_node(e,{},"last",function(f){setTimeout(function(){c.edit(f)},0)})}},share:{separator_before:false,separator_after:true,label:"Share",action:function(c){}}}},current:function(b){return{create:{separator_before:false,separator_after:true,label:"Create",action:function(d){var c=a.jstree._reference(d.reference),e=c.get_node(d.reference);c.create_node(e,{},"last",function(f){setTimeout(function(){c.edit(f)},0)})}},share:{separator_before:false,separator_after:true,label:"Share",action:function(c){}}}},archived:function(b){return{create:{separator_before:false,separator_after:true,label:"Create",action:function(d){var c=a.jstree._reference(d.reference),e=c.get_node(d.reference);c.create_node(e,{},"last",function(f){setTimeout(function(){c.edit(f)},0)})}},share:{separator_before:false,separator_after:true,label:"Share",action:function(c){}}}},trash:function(b){return{empty:{separator_before:false,separator_after:true,label:"Empty Trash",action:function(c){}}}},items:function(b){return{share:{separator_before:false,separator_after:false,label:"Share",action:function(d){var c=a.jstree._reference(d.reference),e=c.get_node(d.reference);c.share_node(e)}},send:{separator_before:false,separator_after:true,label:"Send",action:function(d){var c=a.jstree._reference(d.reference),e=c.get_node(d.reference);c.send_node(e)}},create:{separator_before:false,separator_after:true,label:"Create",action:function(d){var c=a.jstree._reference(d.reference),e=c.get_node(d.reference);c.create_node(e,{},"last",function(f){setTimeout(function(){c.edit(f)},0)})}},rename:{separator_before:false,separator_after:false,label:"Rename",action:function(d){var c=a.jstree._reference(d.reference),e=c.get_node(d.reference);c.edit(e)}},remove:{separator_before:false,icon:false,separator_after:false,label:"Delete",action:function(d){var c=a.jstree._reference(d.reference),e=c.get_node(d.reference);c.delete_node(e)}},ccp:{separator_before:true,icon:false,separator_after:false,label:"Edit",action:false,submenu:{cut:{separator_before:false,separator_after:false,label:"Cut",action:function(d){var c=a.jstree._reference(d.reference),e=c.get_node(d.reference);c.cut(e)}},copy:{separator_before:false,icon:false,separator_after:false,label:"Copy",action:function(d){var c=a.jstree._reference(d.reference),e=c.get_node(d.reference);c.copy(e)}},paste:{separator_before:false,icon:false,_disabled:!(this.can_paste()),separator_after:false,label:"Paste",action:function(d){var c=a.jstree._reference(d.reference),e=c.get_node(d.reference);c.paste(e)}}}}}}},_fn:{show_contextmenu:function(f,b,h){f=this.get_node(f);var e=this.get_settings().contextmenu,c=f.children("a:visible:eq(0)"),g=false,d=false;if(e.show_at_node||typeof b==="undefined"||typeof h==="undefined"){g=c.offset();b=g.left;h=g.top+this.data.core.li_height}if(e.select_node&&this.data.ui&&!this.is_selected(f)){this.deselect_all();this.select_node(f)}switch(a(f).data().ntype){case"incoming":d=e.incoming;break;case"archived":d=e.archived;break;case"current":d=e.current;break;case"trash":d=e.trash;break;default:d=f.data("jstree")&&f.data("jstree").contextmenu?f.data("jstree").contextmenu:e.items}if(a.isFunction(d)){d=d.call(this,f)}a(document).one("context_show.vakata",a.proxy(function(k,j){var i="jstree-contextmenu";if(this.data.themes.theme){i+=" jstree-"+this.data.themes.theme+"-contextmenu"}a(j.element).addClass(i)},this));this.data.contextmenu.visible=true;a.vakata.context.show(c,{x:b,y:h},d);this.__callback({obj:f,x:b,y:h})}}});a.jstree.defaults.plugins.push("contextmenu")})(jQuery);(function(a){a.jstree.plugin("dnd",{__construct:function(){this.get_container().delegate("a","mousedown",a.proxy(function(c){var b=this.get_node(c.target);if(b&&b!==-1&&b.length&&c.which===1){this.get_container().trigger("mousedown.jstree");return a.vakata.dnd.start(c,{jstree:true,origin:this,obj:b},'<div id="jstree-dnd" class="'+(this.data.themes?"jstree-"+this.get_theme():"")+'"><ins class="jstree-icon jstree-er">&#160;</ins>'+this.get_text(c.currentTarget,true)+'<ins class="jstree-copy" style="display:none;">+</ins></div>')}},this))},defaults:{copy_modifier:"ctrl",open_timeout:500}});a(function(){var e=false,d=false,c=a('<div id="jstree-marker">&#160;</div>').hide().appendTo("body");a(document).bind("dnd_start.vakata",function(g,f){e=false}).bind("dnd_move.vakata",function(u,q){if(d){clearTimeout(d)}if(!q.data.jstree){return}if(q.event.target.id&&q.event.target.id==="jstree-marker"){return}var s=a.jstree._reference(q.event.target),k=false,j=false,w=false,m,v,r,f,n,g;if(s&&s.data&&s.data.dnd){c.attr("class",(s.data.themes?"jstree-"+s.get_theme():""));q.helper.children().attr("class",(s.data.themes?"jstree-"+s.get_theme():"")).find(".jstree-copy:eq(0)")[q.event[q.data.origin.get_settings().dnd.copy_modifier+"Key"]?"show":"hide"]();if(q.event.target===s.get_container()[0]||q.event.target===s.get_container_ul()[0]){if(s.check((q.event[q.data.origin.get_settings().dnd.copy_modifier+"Key"]?"copy_node":"move_node"),q.data.obj,-1,"last")){e={ins:s,par:-1,pos:"last"};c.hide();q.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok");return}}else{k=a(q.event.target).closest("a");if(k&&k.length&&k.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")){j=k.offset();w=q.event.pageY-j.top;r=k.height();if(w<r/3){g=["b","i","a"]}else{if(w>r-r/3){g=["a","i","b"]}else{g=w>r/2?["i","a","b"]:["i","b","a"]}}a.each(g,function(i,h){switch(h){case"b":m=j.left-6;v=j.top-5;f=s.get_parent(k);n=k.parent().index();break;case"i":m=j.left-2;v=j.top-5+r/2+1;f=k.parent();n=0;break;case"a":m=j.left-6;v=j.top-5+r+2;f=s.get_parent(k);n=k.parent().index()+1;break}if(s.check((q.event[q.data.origin.get_settings().dnd.copy_modifier+"Key"]?"copy_node":"move_node"),q.data.obj,f,n)){if(h==="i"&&k.parent().is(".jstree-closed")&&s.get_settings(true).dnd.open_timeout){d=setTimeout((function(l,o){return function(){l.open_node(o)}})(s,k),s.get_settings(true).dnd.open_timeout)}e={ins:s,par:f,pos:n};c.css({left:m+"px",top:v+"px"}).show();q.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok");g=true;return false}});if(g===true){return}}}}e=false;q.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er");c.hide()}).bind("dnd_scroll.vakata",function(g,f){if(!f.data.jstree){return}c.hide();e=false;f.helper.find(".jstree-icon:eq(0)").removeClass("jstree-ok").addClass("jstree-er")}).bind("dnd_stop.vakata",function(g,f){if(d){clearTimeout(d)}if(!f.data.jstree){return}c.hide();if(e){e.ins[f.event[f.data.origin.get_settings().dnd.copy_modifier+"Key"]?"copy_node":"move_node"](f.data.obj,e.par,e.pos)}}).bind("keyup keydown",function(g,f){f=a.vakata.dnd._get();if(f.data&&f.data.jstree){f.helper.find(".jstree-copy:eq(0)")[g[f.data.origin.get_settings().dnd.copy_modifier+"Key"]?"show":"hide"]()}});var b="#jstree-marker { position: absolute; top:0; left:0; margin:0; padding:0; border-right:0; border-top:5px solid transparent; border-bottom:5px solid transparent; border-left:5px solid; width:0; height:0; font-size:0; line-height:0; _border-top-color:pink; _border-botton-color:pink; _filter:chroma(color=pink); } #jstree-dnd { line-height:16px; margin:0; padding:4px; } #jstree-dnd .jstree-icon, #jstree-dnd .jstree-copy { display:inline-block; text-decoration:none; margin:0 2px 0 0; padding:0; width:16px; height:16px; } #jstree-dnd .jstree-ok { background:green; } #jstree-dnd .jstree-er { background:red; } #jstree-dnd .jstree-copy { margin:0 2px 0 2px; }";a.vakata.css.add_sheet({str:b,title:"jstree"})});a.jstree.defaults.plugins.push("dnd")})(jQuery);(function(c){if(typeof c.hotkeys==="undefined"&&typeof c.vakata_hotkeys==="undefined"){throw"jsTree hotkeys: jQuery hotkeys plugin not included."}var b=[];function a(e,g){var h=c.jstree._focused(),d;if(h&&h.data&&h.data.hotkeys&&h.data.hotkeys.enabled){d=h.get_settings(true).hotkeys[e];if(d){return d.call(h,g)}}return true}c.jstree.plugin("hotkeys",{__construct:function(){if(!this.data.ui){throw"jsTree hotkeys: jsTree UI plugin not included."}c.each(this.get_settings(true).hotkeys,function(e,d){if(d!==false&&c.inArray(e,b)===-1){c(document).bind("keydown",e,function(f){return a(e,f)});b.push(e)}});this.get_container().bind("lock.jstree",c.proxy(function(){if(this.data.hotkeys.enabled){this.data.hotkeys.enabled=false;this.data.hotkeys.revert=true}},this)).bind("unlock.jstree",c.proxy(function(){if(this.data.hotkeys.revert){this.data.hotkeys.enabled=true}},this));this.enable_hotkeys()},defaults:{up:function(){var d=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this.get_prev(d));return false},"ctrl+up":function(){var d=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this.get_prev(d));return false},"shift+up":function(){var d=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this.get_prev(d));return false},down:function(){var d=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this.get_next(d));return false},"ctrl+down":function(){var d=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this.get_next(d));return false},"shift+down":function(){var d=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this.get_next(d));return false},left:function(){var d=this.data.ui.hovered||this.data.ui.last_selected;if(d){if(d.hasClass("jstree-open")){this.close_node(d)}else{this.hover_node(this.get_prev(d))}}return false},"ctrl+left":function(){var d=this.data.ui.hovered||this.data.ui.last_selected;if(d){if(d.hasClass("jstree-open")){this.close_node(d)}else{this.hover_node(this.get_prev(d))}}return false},"shift+left":function(){var d=this.data.ui.hovered||this.data.ui.last_selected;if(d){if(d.hasClass("jstree-open")){this.close_node(d)}else{this.hover_node(this.get_prev(d))}}return false},right:function(){var d=this.data.ui.hovered||this.data.ui.last_selected;if(d&&d.length){if(d.hasClass("jstree-closed")){this.open_node(d)}else{this.hover_node(this.get_next(d))}}return false},"ctrl+right":function(){var d=this.data.ui.hovered||this.data.ui.last_selected;if(d&&d.length){if(d.hasClass("jstree-closed")){this.open_node(d)}else{this.hover_node(this.get_next(d))}}return false},"shift+right":function(){var d=this.data.ui.hovered||this.data.ui.last_selected;if(d&&d.length){if(d.hasClass("jstree-closed")){this.open_node(d)}else{this.hover_node(this.get_next(d))}}return false},space:function(){if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").click()}return true},"ctrl+space":function(d){d.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(d)}return false},"shift+space":function(d){d.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(d)}return false}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=true},disable_hotkeys:function(){this.data.hotkeys.enabled=false}}});c.jstree.defaults.plugins.push("hotkeys")})(jQuery);(function(a){a.jstree.plugin("html",{defaults:{data:false,ajax:false},_fn:{_append_html_data:function(c,b){b=a(b);if(!b||!b.length||!b.is("ul, li")){return false}c=this.get_node(c);if(c===-1){c=this.get_container()}if(!c.length){return false}if(!c.children("ul").length){c.append("<ul />")}c.children("ul").empty().append(b.is("ul")?b.children("li"):b);return true},_load_node:function(c,f){var e=false,b=this.get_settings().html;c=this.get_node(c);if(!c){return false}switch(!0){case (!b.data&&!b.ajax):if(c===-1){this._append_html_data(-1,this.data.core.original_container_html.clone(true))}return f.call(this,true);case (a.isFunction(b.data)):return b.data.call(this,c,a.proxy(function(g){return f.call(this,this._append_html_data(c,g))},this));case ((!!b.data&&!b.ajax)||(!!b.data&&!!b.ajax&&c===-1)):return f.call(this,this._append_html_data(c,b.data));case ((!b.data&&!!b.ajax)||(!!b.data&&!!b.ajax&&c!==-1)):b.ajax.success=a.proxy(function(j,h,g){var i=this.get_settings().html.ajax;if(a.isFunction(i.success)){j=i.success.call(this,j,h,g)||j}f.call(this,this._append_html_data(c,j))},this);b.ajax.error=a.proxy(function(d,g,i){var h=this.get_settings().html.ajax;if(a.isFunction(h.error)){h.error.call(this,d,g,i)}f.call(this,false)},this);if(!b.ajax.dataType){b.ajax.dataType="html"}if(a.isFunction(b.ajax.url)){b.ajax.url=b.ajax.url.call(this,c)}if(a.isFunction(b.ajax.data)){b.ajax.data=b.ajax.data.call(this,c)}return a.ajax(b.ajax)}}}});a.jstree.defaults.plugins.push("html")})(jQuery);(function(a){a.jstree.plugin("json",{__construct:function(){this.get_container().bind("__after_close.jstree",a.proxy(function(d,c){var b=a(c.rslt.obj);if(this.get_settings(true).json.progressive_unload){b.data("jstree").children=this.get_json(b)[0].children;b.children("ul").remove()}},this))},defaults:{data:false,ajax:false,progressive_render:false,progressive_unload:false},_fn:{parse_json:function(c){var b=this.get_settings(true).json;if(a.isArray(c.children)){if(b.progressive_render){if(!c.data){c.data={}}if(!c.data.jstree){c.data.jstree={}}c.data.jstree.children=c.children;c.children=true}}return this.__call_old(true,c)},_append_json_data:function(c,b){c=this.get_node(c);if(c===-1){c=this.get_container()}b=this.parse_json(b);if(!b||!c.length){return false}if(!c.children("ul").length){c.append("<ul />")}c.children("ul").empty().append(b.is("li")?b:b.children("li"));return true},_load_node:function(c,f){var e=false,b=this.get_settings().json;c=this.get_node(c);if(!c){return false}switch(!0){case (c===-1&&this.get_container().data("jstree")&&a.isArray(this.get_container().data("jstree").children)):e=this.get_container().data("jstree").children;this.get_container().data("jstree").children=null;return f.call(this,this._append_json_data(c,e));case (c!==-1&&c.length&&c.data("jstree")&&a.isArray(c.data("jstree").children)):e=c.data("jstree").children;c.data("jstree").children=null;return f.call(this,this._append_json_data(c,e));case (!b.data&&!b.ajax):throw"Neither data nor ajax settings supplied.";case (a.isFunction(b.data)):return b.data.call(this,c,a.proxy(function(g){return f.call(this,this._append_json_data(c,g))},this));case ((!!b.data&&!b.ajax)||(!!b.data&&!!b.ajax&&c===-1)):return f.call(this,this._append_json_data(c,b.data));case ((!b.data&&!!b.ajax)||(!!b.data&&!!b.ajax&&c!==-1)):b.ajax.success=a.proxy(function(j,h,g){var i=this.get_settings().json.ajax;if(a.isFunction(i.success)){j=i.success.call(this,j,h,g)||j}f.call(this,this._append_json_data(c,j))},this);b.ajax.error=a.proxy(function(d,g,i){var h=this.get_settings().json.ajax;if(a.isFunction(h.error)){h.error.call(this,d,g,i)}f.call(this,false)},this);if(!b.ajax.dataType){b.ajax.dataType="json"}if(a.isFunction(b.ajax.url)){b.ajax.url=b.ajax.url.call(this,c)}if(a.isFunction(b.ajax.data)){b.ajax.data=b.ajax.data.call(this,c)}return a.ajax(b.ajax)}}}})})(jQuery);(function(c){var b=false,a=0;c.jstree.plugin("rules",{__construct:function(){},defaults:{check_max_depth:true,check_max_children:true,check_valid_children:true,types:{}},_fn:{get_rules:function(g){g=this.get_node(g);if(g===-1){g=this.get_container();g=g.data("jstree");return{type:false,max_depth:g&&g.max_depth?g.max_depth:-1,max_children:g&&g.max_children?g.max_children:-1,valid_children:g&&g.valid_children?g.valid_children:-1}}if(!g||!g.length){return false}g=g.data("jstree");var e=this.get_settings().rules,d=this.get_type(g),f={type:d,max_depth:-1,max_children:-1,valid_children:-1};if(d&&e[d]){if(e[d].max_depth){f.max_depth=e[d].max_depth}if(e[d].max_children){f.max_children=e[d].max_children}if(e[d].valid_children){f.valid_children=e[d].valid_children}}if(g&&g.max_depth){f.max_depth=g.max_depth}if(g&&g.max_children){f.max_children=g.max_children}if(g&&g.valid_children){f.valid_children=g.valid_children}return f},get_type:function(d){d=this.get_node(d);if(d===-1){d=this.get_container()}if(!d||!d.length){return false}d=d.data("jstree");return d&&d.type?d.type:false},set_type:function(f,e){f=this.get_node(f);if(f===-1){f=this.get_container()}if(!f||!f.length){return false}var g=f.data("jstree");if(!g){g={}}g.type=e;f.data("jstree",g);return true},check:function(j,g,i,k){if(this.__call_old()===false){return false}var e=false,m=this.get_settings().rules,l=this,f=false,h=0;switch(j){case"create_node":case"move_node":case"copy_node":if(m.check_max_children||m.check_valid_children||m.check_max_depth){e=this.get_rules(i)}if(m.check_max_children){if(typeof e.max_children!=="undefined"&&e.max_children!==-1){if(i.find("> ul >  li").not(j==="move_node"?g:null).length+g.length>e.max_children){return false}}}if(m.check_valid_children){if(typeof e.valid_children!=="undefined"&&e.valid_children!==-1){if(!c.isArray(e.valid_children)){return false}g.each(function(){if(c.inArray(l.get_type(this),e.valid_children)===-1){l=false;return false}});if(l===false){return false}}}if(m.check_max_depth){if(typeof e.max_depth!=="undefined"&&e.max_depth!==-1){if(e.max_depth===0){return false}h=0;if(b!==g){f=g;while(f.length>0){f=f.find("> ul > li");h++}a=h;b=g}else{h=a}f=0;i.children("a:eq(0)").parentsUntil(".jstree","li").each(function(n){var o=l.get_rules(this);if(typeof o.max_depth!=="undefined"&&o.max_depth>=0&&o+n>o.max_depth){l=false;return false}f=n});if(l===false){return false}l=this.get_rules(-1);if(typeof l.max_depth!=="undefined"&&l.max_depth>=0&&h+f>l.max_depth){return false}}}break}return true}}});c.jstree.defaults.plugins.push("rules")})(jQuery);(function(a){a.jstree.plugin("sort",{__construct:function(){this.get_container().bind("load_node.jstree",a.proxy(function(d,b){var c=this.get_node(b.rslt.obj);c=c===-1?this.get_container_ul():c.children("ul");this._sort(c,true)},this)).bind("rename_node.jstree create_node.jstree",a.proxy(function(c,b){this._sort(b.rslt.obj.parent(),false)},this)).bind("move_node.jstree copy_node.jstree",a.proxy(function(d,c){var b=c.rslt.parent===-1?this.get_container_ul():c.rslt.parent.children("ul");this._sort(b,false)},this))},defaults:function(d,c){return this.get_text(d,true)>this.get_text(c,true)?1:-1},_fn:{_sort:function(e,b){var d=this.get_settings(true).sort,c=this;e.append(a.makeArray(e.children("li")).sort(a.proxy(d,c)));e.children("li").each(function(){c.correct_node(this,false)});if(b){e.find("> li > ul").each(function(){c._sort(a(this))});c.correct_node(e.children("li"),true)}}}});a.jstree.defaults.plugins.push("sort")})(jQuery);(function(a){a.jstree.plugin("state",{__construct:function(){if(typeof a.vakata.storage==="undefined"){throw"jsTree state plugin: vakata storage helper not included."}this.get_container().bind("__loaded.jstree",a.proxy(function(c,b){this.restore_state()},this)).bind("__ready.jstree",a.proxy(function(c,b){this.get_container().bind(this.get_settings(true).state.events,a.proxy(function(){this.save_state()},this))},this))},defaults:{key:"jstree",events:"select_node.jstree open_node.jstree close_node.jstree deselect_node.jstree deselect_all.jstree check_node.jstree uncheck_node.jstree uncheck_all.jstree"},_fn:{save_state:function(){var b=this.get_settings(true).state;a.vakata.storage.set(b.key,this.get_state())},restore_state:function(){var c=this.get_settings(true).state,b=a.vakata.storage.get(c.key);if(!!b){this.set_state(b)}}}})})(jQuery);(function(a){var b=[];a.jstree.THEMES_DIR=false;a.jstree.plugin("themes",{__construct:function(){this.get_container().bind("__construct.jstree",a.proxy(function(){var c=this.get_settings(true).themes;this.data.themes.dots=c.dots;this.data.themes.icons=c.icons;if(c.url===false&&c.theme===false){c.theme=this.data.core.rtl?"default-rtl":"default"}this.set_theme(c.theme,c.url,c.no_load)},this)).bind("__construct.jstree __ready.jstree __loaded.jstree",a.proxy(function(){this[this.data.themes.dots?"show_dots":"hide_dots"]();this[this.data.themes.icons?"show_icons":"hide_icons"]()},this))},defaults:{theme:false,url:false,no_load:false,dots:true,icons:true},_fn:{set_theme:function(e,c,d){if(!e){return false}if(!c){c=a.jstree.THEMES_DIR+e+"/style.css"}if(!d&&a.inArray(c,b)===-1){a.vakata.css.add_sheet({url:c});b.push(c)}if(this.data.themes.theme!==e){this.get_container().removeClass("jstree-"+this.data.themes.theme);this.data.themes.theme=e}this.get_container().addClass("jstree-"+e);this.__callback(e)},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=true;this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=false;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){if(this.data.themes.dots){this.hide_dots()}else{this.show_dots()}},show_icons:function(){this.data.themes.icons=true;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=false;this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){if(this.data.themes.icons){this.hide_icons()}else{this.show_icons()}},set_icon:function(d,c){d=this.get_node(d);if(!d||d===-1||!d.length){return false}d=d.find("> a > .jstree-themeicon");if(c===false){this.hide_icon(d)}else{if(c.indexOf("/")===-1){d.addClass(c).attr("rel",c)}else{d.css("background","url('"+c+"') center center no-repeat").attr("rel",c)}}return true},get_icon:function(c){c=this.get_node(c);if(!c||c===-1||!c.length){return null}c=c.find("> a > .jstree-themeicon");if(c.hasClass("jstree-themeicon-hidden")){return false}c=c.attr("rel");return(c&&c.length)?c:null},hide_icon:function(c){c=this.get_node(c);if(!c||c===-1||!c.length){return false}c.find("> a > .jstree-themeicon").addClass("jstree-themeicon-hidden");return true},show_icon:function(c){c=this.get_node(c);if(!c||c===-1||!c.length){return false}c.find("> a > .jstree-themeicon").removeClass("jstree-themeicon-hidden");return true},clean_node:function(d){d=this.__call_old();var c=this;return d.each(function(){var f=a(this),e=f.data("jstree");if(!f.find("> a > ins.jstree-themeicon").length){f.children("a").prepend("<ins class='jstree-icon jstree-themeicon'>&#160;</ins>")}if(e&&typeof e.icon!=="undefined"){c.set_icon(f,e.icon);delete e.icon}})},get_state:function(){var c=this.__call_old();c.themes={theme:this.get_theme(),icons:this.data.themes.icons,dots:this.data.themes.dots};return c},set_state:function(c,d){if(this.__call_old()){if(c.themes){if(c.themes.theme){this.set_theme(c.themes.theme)}if(typeof c.themes.dots!=="undefined"){this[c.themes.dots?"show_dots":"hide_dots"]()}if(typeof c.themes.icons!=="undefined"){this[c.themes.icons?"show_icons":"hide_icons"]()}delete c.themes;this.set_state(c,d);return false}return true}return false},get_json:function(f,d){var e=this.__call_old(),c;if(d){c=this.get_icon(f);if(typeof c!=="undefined"&&c!==null){e.data.jstree.icon=c}}return e}}});a(function(){if(a.jstree.THEMES_DIR===false){a("script").each(function(){if(this.src.toString().match(/jstree[^\/]*?\.js(\?.*)?$/)){a.jstree.THEMES_DIR=this.src.toString().replace(/jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/";return false}})}if(a.jstree.THEMES_DIR===false){a.jstree.THEMES_DIR="themes/"}var c=".jstree a { text-decoration:none; } .jstree a > .jstree-themeicon { height:16px; width:16px; margin-right:3px; } .jstree-rtl a > .jstree-themeicon { margin-left:3px; margin-right:0; } .jstree .jstree-no-icons .jstree-themeicon, .jstree .jstree-themeicon-hidden { display:none; } ";if(a.jstree.IS_IE6){c+=".jstree li a .jstree-themeicon { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a .jstree-themeicon { margin-right:0px; margin-left:3px; } "}a.vakata.css.add_sheet({str:c,title:"jstree"})});a.jstree.defaults.plugins.push("themes")})(jQuery);(function(a){a.jstree.plugin("ui",{__construct:function(){this.data.ui.selected=a();this.data.ui.hovered=null;this.data.ui.last_selected=false;this.get_container().delegate("a","click.jstree",a.proxy(function(g){g.preventDefault();g.currentTarget.blur();var c=this.get_settings(true).ui,f=this.get_node(g.currentTarget),h=this.is_selected(f),b=c.select_multiple_modifier==="on"||(c.select_multiple_modifier!==false&&g&&g[c.select_multiple_modifier+"Key"]),d=c.select_multiple_modifier==="on"||(c.select_range_modifier!==false&&g&&g[c.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==f[0]&&this.data.ui.last_selected.parent()[0]===f.parent()[0]);switch(!0){case (d&&this.data.ui.last_selected!==false):this.select_range(f);break;case (d&&this.data.ui.last_selected===false):this.select_one(f);break;case (h&&b):this.deselect_node(f);break;default:this.select_one(f,b);break}},this)).delegate("a","mouseenter.jstree",a.proxy(function(b){this.hover_node(b.target)},this)).delegate("a","mouseleave.jstree",a.proxy(function(b){this.dehover_node(b.target)},this)).bind("delete_node.jstree",a.proxy(function(c,d){var e=this.get_node(d.rslt.obj),f=(e&&e.length)?e.find("a.jstree-clicked"):a(),b=this;f.each(function(){b.deselect_node(this)})},this)).bind("move_node.jstree",a.proxy(function(b,c){if(c.rslt.cy){c.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")}},this))},defaults:{select_multiple_modifier:"ctrl",select_range_modifier:"shift",disable_nested_selection:true},_fn:{get_node:function(b,c){if(typeof b==="undefined"||b===null){return c?this.data.ui.selected:this.data.ui.last_selected}return this.__call_old()},hover_node:function(b){b=this.get_node(b);if(!b||!b.length||this.is_loading(b)){return false}if(!b.hasClass("jstree-hovered")){this.dehover_node()}this.data.ui.hovered=b.children("a").addClass("jstree-hovered").parent();this.scroll_to_node(b);this.__callback({obj:b})},dehover_node:function(){var c=this.data.ui.hovered,b;if(!c||!c.length){return false}b=c.children("a").removeClass("jstree-hovered").parent();if(this.data.ui.hovered[0]===b[0]){this.data.ui.hovered=null}this.__callback({obj:c})},select_node:function(c){var b=this;c=this.get_node(c);if(c===-1||!c||!c.length||this.is_loading(c)){return false}c.children("a").addClass("jstree-clicked");this.data.ui.last_selected=c;this.data.ui.selected=this.data.ui.selected.add(c);c.parents(".jstree-closed").each(function(){b.open_node(this,false,0)});this.__callback({obj:c})},deselect_node:function(b){b=this.get_node(b);if(!b||!b.length){return false}if(this.is_selected(b)){b.children("a").removeClass("jstree-clicked");this.data.ui.selected=this.data.ui.selected.not(b);if(this.data.ui.last_selected.get(0)===b.get(0)){this.data.ui.last_selected=this.data.ui.selected.eq(0)}this.__callback({obj:b})}},deselect_all:function(c){var b=c?a(c).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();b.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=a();this.data.ui.last_selected=false;this.__callback({obj:b})},is_selected:function(b){return this.data.ui.selected.index(this.get_node(b))>=0},get_selected:function(b){return b?a(b).find("a.jstree-clicked").parent():this.data.ui.selected},select_range:function(f,d,b){var g=this,c,e;f=this.get_node(f);if(!d){e=true;d=this.data.ui.last_selected}d=this.get_node(d);if(f===-1||!f||!f.length||this.is_loading(f)){return false}if(d===-1||!d||!d.length||this.is_loading(d)){return false}if(!b){this.deselect_all()}c=(f.index()<d.index());d.addClass("jstree-last-selected");f=f[c?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf().add(".jstree-last-selected");d.removeClass("jstree-last-selected");if(!c){f=f.vakata_reverse()}if(!f.length){return false}f.each(function(){g.select_node(this)});if(e){this.data.ui.last_selected=d}this.__callback({obj:f});return true},select_one:function(c,b){c=this.get_node(c);if(c===-1||!c||!c.length||this.is_loading(c)){return false}if(!b){this.deselect_all()}else{if(this.get_settings(true).ui.disable_nested_selection&&((c.parentsUntil(".jstree","li").children("a.jstree-clicked:eq(0)").length)||(c.children("ul").find("a.jstree-clicked:eq(0)").length))){return false}}this.select_node(c);this.__callback({obj:c});return true},clean_node:function(b){b=this.__call_old();var c=this;return b.each(function(){var e=a(this),f=e.data("jstree");e.find(".jstree-clicked").removeClass("jstree-clicked");if(f&&f.selected){c.select_node(e);delete f.selected}})},get_state:function(){var b=this.__call_old();b.selected=[];this.data.ui.selected.each(function(){b.selected.push(this.id)});return b},set_state:function(b,d){if(this.__call_old()){if(b.selected){var c=this;this.deselect_all();a.each(b.selected,function(f,e){c.select_node(document.getElementById(e))});delete b.selected;this.set_state(b,d);return false}return true}return false},get_json:function(d,b){var c=this.__call_old();if(b){if(this.is_selected(d)){c.data.jstree.selected=true}}return c}}});a.jstree.defaults.plugins.push("ui")})(jQuery);(function(a){a.jstree.plugin("unique",{_fn:{check:function(b,f,e,i){if(!this.__call_old()){return false}e=e===-1?this.get_container():e;var h=b==="rename_node"?a("<div />").html(i).text():this.get_text(f,true),g=[],d=this;e.children("ul").children("li").each(function(){g.push(d.get_text(this,true))});switch(b){case"delete_node":return true;case"rename_node":case"copy_node":return(a.inArray(h,g)===-1);case"move_node":return(e.children("ul").children("li").index(f)!==-1||a.inArray(h,g)===-1)}return true}}});a.jstree.defaults.plugins.push("unique")})(jQuery);(function(c){var b={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">	<xsl:call-template name="nodes">		<xsl:with-param name="node" select="/root" />	</xsl:call-template></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<ul>	<xsl:for-each select="$node/item">		<xsl:variable name="children" select="count(./item) &gt; 0" />		<li>			<xsl:for-each select="@*"><xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute></xsl:for-each>			<a>				<xsl:for-each select="./content/@*"><xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute></xsl:for-each>				<xsl:copy-of select="./content/child::node()" />			</a>			<xsl:if test="$children"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>		</li>	</xsl:for-each>	</ul></xsl:template></xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">	<ul>	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">		<xsl:call-template name="nodes">			<xsl:with-param name="node" select="." />		</xsl:call-template>	</xsl:for-each>	</ul></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />	<li>		<xsl:for-each select="@*">			<xsl:if test="name() != \'parent_id\'">				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>			</xsl:if>		</xsl:for-each>		<a>			<xsl:for-each select="./content/@*"><xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute></xsl:for-each>			<xsl:copy-of select="./content/child::node()" />		</a>		<xsl:if test="$children">		<ul>			<xsl:for-each select="//item[@parent_id=$node/attribute::id]">				<xsl:call-template name="nodes">					<xsl:with-param name="node" select="." />				</xsl:call-template>			</xsl:for-each>		</ul>		</xsl:if>	</li></xsl:template></xsl:stylesheet>'},a=function(d){return d.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};c.jstree.plugin("xml",{defaults:{xsl:"flat",data:false,ajax:false},_fn:{_append_xml_data:function(e,d){d=c.vakata.xslt(d,b[this.get_settings().xml.xsl]);if(d===false){return false}d=c(d);if(!d||!d.length||!d.is("ul, li")){return false}e=this.get_node(e);if(e===-1){e=this.get_container()}if(!e.length){return false}if(!e.children("ul").length){e.append("<ul />")}e.children("ul").empty().append(d.is("ul")?d.children("li"):d);return true},_load_node:function(f,h){var g=false,e=this.get_settings().xml;f=this.get_node(f);if(!f){return false}switch(!0){case (c.isFunction(e.data)):return e.data.call(this,f,c.proxy(function(i){return h.call(this,this._append_xml_data(f,i))},this));case ((!!e.data&&!e.ajax)||(!!e.data&&!!e.ajax&&f===-1)):return h.call(this,this._append_xml_data(f,e.data));case ((!e.data&&!!e.ajax)||(!!e.data&&!!e.ajax&&f!==-1)):e.ajax.success=c.proxy(function(l,j,i){var k=this.get_settings().xml.ajax;if(c.isFunction(k.success)){l=k.success.call(this,l,j,i)||l}h.call(this,this._append_xml_data(f,l))},this);e.ajax.error=c.proxy(function(d,i,k){var j=this.get_settings().xml.ajax;if(c.isFunction(j.error)){j.error.call(this,d,i,k)}h.call(this,false)},this);if(!e.ajax.dataType){e.ajax.dataType="xml"}if(c.isFunction(e.ajax.url)){e.ajax.url=e.ajax.url.call(this,f)}if(c.isFunction(e.ajax.data)){e.ajax.data=e.ajax.data.call(this,f)}return c.ajax(e.ajax)}},get_xml:function(g,f,d){var e="";if(!g){g="flat"}if(typeof d==="undefined"){f=this.get_json(f);c.each(f,c.proxy(function(j,h){e+=this.get_xml(g,h,true)},this));return'<?xml version="1.0" encoding="utf-8" ?><root>'+e+"</root>"}e+="<item";if(g==="flat"&&d!==true){e+=' parent_id="'+a(d)+'"'}if(f.data&&!c.isEmptyObject(f.data)){c.each(f.data,function(j,h){if(!c.isEmptyObject(h)){e+=" data-"+j+'="'+a(c.vakata.json.encode(h))+'"'}})}c.each(f.li_attr,function(j,h){e+=" "+j+'="'+a(h)+'"'});e+=">";e+="<content";c.each(f.a_attr,function(j,h){e+=" "+j+'="'+a(h)+'"'});e+="><![CDATA["+f.title+"]]></content>";if(g==="flat"){e+="</item>"}if(f.children){c.each(f.children,c.proxy(function(j,h){e+=this.get_xml(g,h,f.li_attr&&f.li_attr.id?f.li_attr.id:true)},this))}if(g==="nest"){e+="</item>"}return e}}});c.jstree.defaults.plugins.push("xml")})(jQuery);(function(a){a.jstree.plugin("helpers",{_fn:{get_path:function(d,b){var c=[],e=this;d=this.get_node(d);if(d===-1||!d||!d.length){return false}d.parentsUntil(".jstree","li").each(function(){c.push(b?this.id:e.get_text(this))});c.reverse();c.push(b?d.attr("id"):this.get_text(d));return c}}})})(jQuery);